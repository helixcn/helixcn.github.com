<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Jinlong Zhang&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Jinlong Zhang&#39;s blog">
<meta property="og:url" content="https://helixcn.github.io/page/12/index.html">
<meta property="og:site_name" content="Jinlong Zhang&#39;s blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Jinlong Zhang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Jinlong Zhang's blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jinlong Zhang&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://helixcn.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-2016-05-12-wenchuan" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2016/05/12/2016-05-12-wenchuan/" class="article-date">
  <time class="dt-published" datetime="2016-05-11T16:45:54.000Z" itemprop="datePublished">2016-05-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2016/05/12/2016-05-12-wenchuan/">那一刻之后 汶川大地震八周年祭</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>八年了，</p>
<p>这世界有了多少改变？</p>
<p>多少生命定格在那一刻？</p>
<p>&nbsp;</p>
<p>那一刻之后，</p>
<p>我们关注，</p>
<p>我们哭泣，</p>
<p>我们倾自己的能力去挽救。</p>
<p>&nbsp;</p>
<p>那一刻之后，</p>
<p>大地揭开了多少善与恶？</p>
<p>&nbsp;</p>
<p>大地的伤痕，</p>
<p>把最纯粹的展示给你。</p>
<p>&nbsp;</p>
<p>那之后不久，</p>
<p>大地再次愈合，</p>
<p>而人心却难以愈合。</p>
<p>&nbsp;</p>
<p>人们希望，</p>
<p>这世界上多一些善良与纯粹。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://helixcn.github.io/2016/05/12/2016-05-12-wenchuan/" data-id="ckmq42ajc007n1k8451f3fm21" data-title="那一刻之后 汶川大地震八周年祭" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AF%97%E6%AD%8C/" rel="tag">诗歌</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2016-5-8-revol" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2016/05/07/2016-5-8-revol/" class="article-date">
  <time class="dt-published" datetime="2016-05-07T08:52:54.000Z" itemprop="datePublished">2016-05-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2016/05/07/2016-5-8-revol/">《R编程与进化分析》幻灯片（2016年5月9日 北京）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>受中国科学院植物研究所赖江山博士邀请， 本人于2016年5月9日在北京昌平讲解《R编程与进化分析》。</p>
<p>幻灯片如下</p>
<p><a target="_blank" rel="noopener" href="http://blog.sciencenet.cn/home.php?mod=attachment&id=84573">PCM_00.pdf</a><br><a target="_blank" rel="noopener" href="http://blog.sciencenet.cn/home.php?mod=attachment&id=84574">PCM_01.pdf</a><br><a target="_blank" rel="noopener" href="http://blog.sciencenet.cn/home.php?mod=attachment&id=84575">PCM_02.pdf</a><br><a target="_blank" rel="noopener" href="http://blog.sciencenet.cn/home.php?mod=attachment&id=84614">PCM_03.pdf</a></p>
<p>主要内容</p>
<ol>
<li>R开发平台的搭建</li>
<li>R脚本</li>
<li>R的编程习惯</li>
<li>编写R函数</li>
<li>程序包的结构</li>
<li>S3与S4 Methods</li>
<li>程序包的安装和检查</li>
<li>结合Rcpp编写程序包</li>
<li>从github安装程序包</li>
<li>使用git记录程序更改， 并更新github</li>
</ol>
<p>正则表达式与基本文本处理</p>
<ol>
<li>gsub</li>
<li>grepl</li>
<li>%in%</li>
<li>regexpr</li>
<li>gregexpr</li>
</ol>
<p>极大似然以及贝叶斯的基本原理</p>
<ol>
<li>用极大似然法估计线性模型的参数</li>
<li>用MCMCMC估计现行模型的参数</li>
<li>Bootstrap的原理以及应用</li>
<li>Permutation的基本原理</li>
</ol>
<p>进化树基础</p>
<ol>
<li>fasta文件</li>
<li>Phylip文件</li>
<li>Newick文件</li>
<li>Nexus文件</li>
</ol>
<p>DNA Barcoding 序列构建进化树</p>
<ol>
<li>fasta文件</li>
<li>用MUSCLE进行Alignment</li>
<li>用phylotools生成supermatrix （relaxed phylip文件）</li>
<li>用RAxML构建极大似然进化树</li>
<li>用r8s进行分子钟校订</li>
</ol>
<p>基于植物名录建立进化树</p>
<ol>
<li>植物名录</li>
<li>用plantlist程序包生成科属种列表 （基于APGIII）</li>
<li>用科属种列表提交到Phylomatic， 基于Zanne2014进化树生成种水平的进化树</li>
</ol>
<p>进化树在R中的操作</p>
<p>CRAN Task Views: Phylogenetics</p>
<ol>
<li><p>Figtree显示进化树</p>
</li>
<li><p>ggtree： 进化树绘图</p>
</li>
<li><p>ape程序包简介<br> (1)phylo类型简介以及提取<br> (2)绘制进化树<br> (3)祖先状态重建<br> (4)ltt plot</p>
</li>
<li><p>Picante 群落系统发育， 计算 Faith’ PD， 计算系统发育信号， 计算community phylogenetic structure, PIC, Pybus Gamma</p>
</li>
<li><p>laser: 基于极大似然法对物种分化速率和灭绝速率进行估计 speciation and extinction rate.</p>
</li>
<li><p>geiger: 计算MEDUSA</p>
</li>
</ol>
<p>需要安装的软件， 以及用到的软件在 百度盘 (448M), 可以点击以下链接下载 </p>
<p> <a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1geCc9iz">http://pan.baidu.com/s/1geCc9iz</a></p>
<p>该压缩文件内容如下</p>
<ol>
<li>7z1514-x64.exe*</li>
<li>basic-miktex-2.9.5872-x64.exe*</li>
<li>Git-2.7.2-32-bit_setup.1457942412.exe*</li>
<li>npp_6.9.1_Installer.1459233531.exe*</li>
<li>out.txt</li>
<li>package example/</li>
<li>phylogenetic/</li>
<li>R-3.2.5-win.exe*</li>
<li>Rtools33.exe*</li>
<li>XnViewMP-win-x64.exe*</li>
<li>安装指南.txt</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://helixcn.github.io/2016/05/07/2016-5-8-revol/" data-id="ckmq42ajj00881k84eir4cj83" data-title="《R编程与进化分析》幻灯片（2016年5月9日 北京）" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R%E7%BC%96%E7%A8%8B/" rel="tag">R编程</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2016-4-21-cvlatex" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2016/04/20/2016-4-21-cvlatex/" class="article-date">
  <time class="dt-published" datetime="2016-04-20T08:19:54.000Z" itemprop="datePublished">2016-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2016/04/20/2016-4-21-cvlatex/">个人简历的Latex模板</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>用Latex制作的简历风格清爽 。</p>
<p>这里给出本人中文简历的源代码。 请将 代码拷贝到纯文本文件中，并用UTF8 编码。 </p>
<p>在Linux Mint下， 完整安装TexLive， 以及TexWorks， 通过TexWorks界面的pdflatex编译为pdf。</p>
<p>也可以在Windows 下的 Miktex所提供的TexWorks下编译为pdf。</p>
<p>编译时需要在文件夹中包含 resume.cls 文件。 请点击下载。</p>
<p>编译成的pdf效果如图。</p>
<p><a target="_blank" rel="noopener" href="http://blog.sciencenet.cn/home.php?mod=attachment&id=83334">Jinlong_Zhang_Chinese20160418.pdf</a></p>
<p>编译时需要的cls文件</p>
<p><a target="_blank" rel="noopener" href="http://blog.sciencenet.cn/home.php?mod=attachment&id=83333">resume.cls</a></p>
<pre><code class="latex">**%%%** Latex代码开始
%____________
% LaTeX2e  for Jinlong Zhang
\documentclass[a4paper, 12pt, margin, line]&#123;resume&#125;
%pagestyle&#123;plain&#125;
\usepackage&#123;CJKutf8&#125;
\usepackage[usenames]&#123;color&#125;
\usepackage&#123;hyperref&#125;
\hypersetup&#123;colorlinks,
       linkcolor=black,
       filecolor=black,
       urlcolor=blue,
       citecolor=black&#125; 
\pagenumbering&#123;roman&#125;
\name&#123;Large 个人简历&#125;
%______________________________________________________________________________________________________________________
\begin&#123;document&#125;
\begin&#123;CJK&#125;&#123;UTF8&#125;&#123;gbsn&#125;
\begin&#123;resume&#125;
\renewcommand&#123;today&#125;&#123;numberyear 年 numbermonth 月 numberday 日&#125;
%__________________________________________________________________________________________________________________
% Contact Information
\section&#123;mysidestyle &#123;\bf 联系信息&#125;&#125;
   \textbf&#123;Large 张金龙&#125; 博士\
   \textbf&#123;性别:&#125; 男                                                                                                                                                           \
   \textbf&#123;籍贯:&#125; 天津宝坻                                                                                    \
   \textbf&#123;地址:&#125; 香港新界大埔林锦公路 嘉道理农场暨植物园 植物保育部                   \
   \textbf&#123;办公室电话&#125;: 00852-00000000 \
   \textbf&#123;手机&#125;: 00852-00000000 \
   \textbf&#123;电子信箱&#125;: href&#123;mailto:jinlongzhang01@gmail.com&#125;&#123;jinlongzhang01@gmail.com&#125;                                                                                                               \textbf&#123;个人主页&#125;: &#123;tt href&#123;http://phylodiversity.net/jinlongzhang/&#125;&#123;http://phylodiversity.net/jinlongzhang/&#125;&#125;
   \textbf&#123;github主页&#125;: &#123;tt href&#123;https://github.com/helixcn/&#125;&#123;https://github.com/helixcn/&#125;&#125;
   \textbf&#123;科学网博客&#125;: &#123;tt href&#123;http://blog.sciencenet.cn/u/zjlcas&#125;&#123;http://blog.sciencenet.cn/u/zjlcas&#125;&#125;
% &#123;color&#123;blue&#125;&#123;http://phylodiversity.net/jinlongzhang/&#125;&#125;
%___________
% Research Interests
\section&#123;mysidestyle &#123;\bf 研究领域&#125;&#125;
1. 群落生态学               \
2. 系统发育比较分析与适应性进化 \
3. 物种地理分布格局与宏生态学\
4. R,Python, C++++ 统计编程.
%______
% Employment
\section&#123;mysidestyle &#123;\bf 工作单位&#125;&#125; 
\textbf&#123;高级生态学主任、标本馆馆长&#125;\
嘉道理农场暨植物园植物保育部 hfill 2015年4月 - 现在 
\textbf&#123;植物鉴定和记录主任&#125;\
嘉道理农场暨植物园植物保育部 hfill 2013年1月 -2015年3月
%________
% Education
\section&#123;\mysidestyle &#123;\bf 教育背景&#125;&#125; 
   \textbf&#123;理学博士：生态学&#125; hfill 中国科学院植物研究所 2012年                                  \%
   论文题目:\hspace&#123; 3mm &#125;
   \textsl&#123;植物系统发育多样性格局及其环境解释: 从群落到区域&#125;                                       \
   导师: 马克平 研究员                                                                          %
   \textbf&#123;理学硕士：植物学&#125; hfill 东北农业大学 2008年                                         \%
   论文题目:\hspace&#123; 3mm &#125; 
   \textsl&#123;东北早春类短命植物区系及分布格局研究&#125;                                                  \
  导师: 李晶 教授 及 马克平 研究员
   textbf&#123;理学学士：生物学&#125; hfill 东北农业大学 2005年                               
%__________________________________________________________________________________________________________________
\section&#123;\mysidestyle &#123;\bf 专业技能&#125;&#125;
&#123;\bf 植物鉴定: &#125;
中国东部常见种子植物除个别科以外可直接鉴定到属， 华南以及东北常见植物可以鉴定到种。
 2005到2016年之间考察的区域包括： 东北、华南、 西南、华中、华东、香港特别行政区， 瑞典西博腾等 。大部分植物照片已经鉴定并且上传到中国自然标本馆
(&#123;tt href&#123;http://www.cfh.ac.cn/Album/UserAlbums.aspx?Username=helixcn&#125;&#123;http://www.cfh.ac.cn/Album/UserAlbums.aspx?Username=helixcn&#125; &#125;). 
&#123;\bf 分子生物学实验技能：&#125;
DNA提取、 PCR、琼脂糖凝胶电泳、毛细管电泳 (CE)、SSR 以及亲本分析 
&#123;\bf 计算机语言：&#125;
R(熟练)、 C、C++++、FORTRAN、 Python、SQL、LaTeX
&#123;\bf 本人编写的R程序包：&#125;
phylotools、spaa、HK80、plantlist、skycalc、herblabel
&#123;\bf 掌握的软件：&#125;
PAUP*, PHYLIP, MrBayes, PHYML, RAxML, r8s, BEAST, MEGA, Phylocom, Phylomatic, Mesquite, ape, geiger, ArcGIS, DIVA-GIS, Maxent
section&#123;mysidestyle &#123;\bf 植物考察&#125;&#125;
\textsl&#123;\bf&#123;2016年4月&#125;&#125;       \hfill 广东封开县黑石顶考察50公顷森林样地            
\textsl&#123;\bf&#123;2013年到2016年&#125;&#125;  \hfill 香港植物调查与摄影                    
\textsl&#123;\bf&#123;2007年12月&#125;&#125;       \hfill 浙江省开化县古田山森林样地植物回访研究         
\textsl&#123;\bf&#123;2004, 2005 and 2006年暑假&#125;&#125; hfill  textbf&#123;辽宁省鞍山市千山&#125; 
东北农业大学植物学野外实习老师
%__________________________________________________________________________________________________________________
%  Academic Presentations
\section&#123;mysidestyle &#123;\bf 学术审稿:&#125;&#125;
\textsl&#123;生物多样性&#125;,
\textsl&#123;Journal of Ecology&#125;, 
\textsl&#123;PLoS One&#125;, 
\textsl&#123;Journal of Systematics and Evolution&#125;,
\textsl&#123;Journal of Plant Ecology&#125;, 
\textsl&#123;Plant Ecology and Diversity&#125;, 
\textsl&#123;Animal Systematics Evolution and Diversity&#125;
%__________________________________________________________________________________________________________________
% Publications
section&#123;mysidestyle &#123;\bf 近五年发表论文 &#125;&#125;
&#123;\bf 2015 年&#125;
Qian, Hong and Field, Richard and &#123;\bf Zhang, Jin-Long&#125; and Zhang, Jian and Chen, Shengbin. (2015) Phylogenetic structure and ecological and evolutionary determinants of species richness for angiosperm trees in forest communities in China.  textsl &#123;Journal of Biogeography&#125;, 43(3):603–615.
&#123;\bf 2014 年&#125;
Chen, S., Mao, L., &#123;\bf Zhang, J.&#125;, Zhou, K. and Gao, J. (2014). Environmental determinants of geographic butterfly richness pattern in eastern China. textsl &#123;Biodiversity and conservation&#125;, 23(6), 1453-1467.
&#123;\bf 张金龙&#125;，马克平.2014.种间联接和生态位重叠的计算:spaa程序包. 见马克平主编.中国生物多样性保护与研究进展X.北京:气象出版社,165-174
section&#123;mysidestyle &#123;\bf 参编书籍&#125;&#125;
李晶，苍晶，&#123;\bf 张金龙&#125; (2014) 黑龙江常见野生植物图鉴. 北京. 高等教育出版社
%__________________________________________________________________________________________________________________
% Referees
\\section&#123;mysidestyle &#123;\bf 证明人&#125;&#125;
\begin&#123;tabular&#125;&#123;@&#123;&#125;p&#123;7.5cm&#125;p&#123;7.5cm&#125;&#125; 
\textbf&#123;某某 博士&#125;                                            &amp; \textbf&#123;某某 研究员&#125;                            \
香港嘉道理农场暨植物园                                                     &amp; 中国科学院植物研究所                                \
植物保育部部门主管                                                        &amp; 植被与气候变化国家重点实验室                          \
Email: \href&#123;mailto: xxx@kfbg.org&#125;&#123;\textsl&#123;xxx@kfbg.org&#125; &#125;   &amp; Email:\href&#123;mailto:aaa@ibcas.ac.cn&#125;&#123;\textsl&#123;aaa@ibcas.ac.cn&#125;&#125; \
\end&#123;tabular&#125;
&#123;\hfill 更新日期: \today&#125;
%______________________________________________________________________________________________________________________
\end&#123;resume&#125;
\end&#123;CJK&#125;         % 结束中文环境
\end&#123;document&#125;
</code></pre>
<p><strong>%%% Latex代码  结束</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://helixcn.github.io/2016/04/20/2016-4-21-cvlatex/" data-id="ckmq42ajh00841k84e4k42908" data-title="个人简历的Latex模板" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8E%92%E7%89%88/" rel="tag">排版</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2016-4-10-ggtree" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2016/04/10/2016-4-10-ggtree/" class="article-date">
  <time class="dt-published" datetime="2016-04-10T07:21:54.000Z" itemprop="datePublished">2016-04-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2016/04/10/2016-4-10-ggtree/">在R中绘制进化树：ggtree学习笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>ggtree （<a target="_blank" rel="noopener" href="https://guangchuangyu.github.io/software/ggtree/%EF%BC%89%E6%98%AF%E9%A6%99%E6%B8%AF%E5%A4%A7%E5%AD%A6%E4%BD%99%E5%85%89%E5%88%9B%E5%8D%9A%E5%A3%AB%E7%BC%96%E5%86%99%E7%9A%84R%E7%A8%8B%E5%BA%8F%E5%8C%85%E3%80%82ggtree%E6%98%AFggplot2%E7%A8%8B%E5%BA%8F%E5%8C%85%E7%9A%84%E6%89%A9%E5%B1%95">https://guangchuangyu.github.io/software/ggtree/）是香港大学余光创博士编写的R程序包。ggtree是ggplot2程序包的扩展</a> (<a target="_blank" rel="noopener" href="http://www.ggplot2-exts.org/)%EF%BC%8C%E8%83%BD%E5%A4%9F%E5%83%8Fggplot2%E4%B8%80%E6%A0%B7%EF%BC%8C%E7%94%A8%E5%9B%BE%E5%B1%82%E5%8C%96%E7%9A%84%E8%AF%AD%E6%B3%95%E7%BB%98%E5%88%B6%E8%BF%9B%E5%8C%96%E6%A0%91%E3%80%82%E8%BF%99%E4%B8%8EAPE%E7%94%A8%E5%8F%82%E6%95%B0%E6%8E%A7%E5%88%B6%E7%BB%98%E5%9B%BE%E6%98%8E%E6%98%BE%E4%B8%8D%E5%90%8C%E3%80%82%E4%B8%8Eggplot2%E4%B8%80%E6%A0%B7%EF%BC%8C%E5%9C%A8ggtree%E4%B8%AD%EF%BC%8C%E9%80%9A%E8%BF%87%E4%B8%8D%E5%90%8C%E7%9A%84%E5%9B%BE%E5%B1%82%E7%BB%84%E5%90%88%E5%8D%B3%E5%8F%AF%E7%BB%98%E5%88%B6%E5%87%BA%E6%9B%B4%E4%B8%BA%E5%A4%8D%E6%9D%82%E7%9A%84%E5%9B%BE%E5%BD%A2%E3%80%82">http://www.ggplot2-exts.org/)，能够像ggplot2一样，用图层化的语法绘制进化树。这与APE用参数控制绘图明显不同。与ggplot2一样，在ggtree中，通过不同的图层组合即可绘制出更为复杂的图形。</a></p>
<p>该程序包在正式发布之前就受到CRAN Task Views:Phylogenetics 的作者Brian O’Meara 的关注。ggtree发布在Bioconductor之后，更是受到国际同行的广泛赞誉。作者介绍ggtree的论文在英国生态学会的Methods in Ecology and Evolution发表之后， 在不到一年的时间里， 引用次数已经超过100，可见受欢迎程度。</p>
<p>在数据分析中，读取进化树一般是用ape程序包的read.tree(), 但是构建进化树时，不同软件生成的文件格式多种多样，虽然大部分都是以newick或者nexus格式为基础，但是有时要将进化树建立过程中的信息标注在进化树上，这时read.tree读取的信息往往不足，编写函数导入相关信息也比较麻烦。鉴于此，作者为ggtree编写了读取进化树的函数，以弥补ape程序包read.tree的不足。ggtree能够读取并转换BEAST, r8s，RAxML等软件所生成的数据。用户也可自定义数据，轻松实现R实现基于进化树的高级绘图。</p>
<p>余博士关于ggtree的介绍：</p>
<p><a target="_blank" rel="noopener" href="http://cos.name/2015/11/to-achieve-the-visualization-and-annotation-of-evolutionary-tree-using-ggtree/">http://cos.name/2015/11/to-achieve-the-visualization-and-annotation-of-evolutionary-tree-using-ggtree/</a></p>
<p>本笔记主要基于：<br><a target="_blank" rel="noopener" href="http://www.bioconductor.org/packages/release/bioc/vignettes/ggtree/inst/doc/ggtree.html">http://www.bioconductor.org/packages/release/bioc/vignettes/ggtree/inst/doc/ggtree.html</a></p>
<pre><code class="R">#### ggtree可以直接读取的数据格式

Newick (via ape)
Nexus (via ape)
New Hampshire eXtended format (NHX) （http://home.cc.umanitoba.ca/~psgendb/doc/atv/NHX.pdf）
Jplace （http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0031009）
Phylip

以及以下软件输出的数据:

BEAST2
EPA3
HYPHY5
PAML1
PHYLDOG6
pplacer4
r8s7
RAxML8
RevBayes9

####################################################
用以下函数读取
read.beast()       ## for parsing output of BEASE
read.codeml()      ## for parsing output of CODEML (rst and mlc files)
read.codeml_mlc()  ## for parsing mlc file (output of CODEML)
read.hyphy()       ## for parsing output of HYPHY
read.jplace()      ## for parsing jplace file including output from EPA and pplacer
read.nhx()         ## for parsing NHX file including output from PHYLODOG and RevBayes
read.paml_rst()    ## for parsing rst file (output of BASEML and CODEML)
read.r8s()         ## for parsing output of r8s
read.raxml()       ## for parsing output of RAxML

#####################################################
###### 定义的 S4 Classes #####################################
apeBootstrap ##for bootstrap analysis of ape::boot.phylo()10, output of apeBoot() defined in ggtree
beast        ##for storing output of read.beast()
codeml       ## for storing output of read.codeml()
codeml_mlc   ##for storing output of read.codeml_mlc()
hyphy        ## for storing output of read.hyphy()
jplace       ## for storing output of read.jplace()
nhx          ## for storing output of read.nhx()
paml_rst     ## for rst file obtained by PAML, including BASEML and CODEML.
phangorn     ## for storing ancestral sequences inferred by R package phangorn11, output of phyPML defined in ggtree
r8s          ## for storing output of read.r8s()
raxml        ## for storing output of read.raxml()

### 其他支持的S4 类
###

phylo, 
multiPhylo (defined by ape10), 
phylo4 (defined by phylobase) 
obkData (defined in OutbreakTools) and 
phyloseq (defined in phyloseq).

### 获取任何能够在进化树上显示的参数
get.fields

### 显示进化树
ggtree(tree_object)

### 将任何格式的进化树转换为 phylo格式
get.tree

### 界定分类单元
groupOTU()
groupClade()

### 将进化树转换为 data.frame
fortify

############################################
#########3 举例： BEAST

library(ggtree)
file &lt;- system.file(&quot;extdata/BEAST&quot;, &quot;beast_mcc.tree&quot;, package=&quot;ggtree&quot;)
beast &lt;- read.beast(file)
beast

get.fields(beast)
ggtree(beast, ndigits = 2, branch.length = &#39;none&#39;) + geom_text(aes(x = branch, label =length_0.95_HPD), vjust = -.5, color = &#39;firebrick&#39;)

######### 导入的数据通过 fortify函数能够转换为 data.frame
beast_data &lt;- fortify(beast)
head(beast_data)


################ PAML
brstfile &lt;- system.file(&quot;extdata/PAML_Baseml&quot;, &quot;rst&quot;, package=&quot;ggtree&quot;)
brst &lt;- read.paml_rst(brstfile)
brst

p &lt;- ggtree(brst) +
   geom_text(aes(x = branch, label = marginal_AA_subs), vjust=-.5, color=&#39;steelblue&#39;) +
   theme_tree2()
print(p)

################# CODEML
crstfile &lt;- system.file(&quot;extdata/PAML_Codeml&quot;, &quot;rst&quot;, package=&quot;ggtree&quot;)
crst &lt;- read.paml_rst(crstfile)
crst

##### %&lt;% 类似于格式刷， 将某一进化树绘制时的参数， 转移到要绘制的进化树中
p %&lt;% crst

################ 
#### CODEML mlc文件
mlcfile &lt;- system.file(&quot;extdata/PAML_Codeml&quot;, &quot;mlc&quot;, package=&quot;ggtree&quot;)
mlc &lt;- read.codeml_mlc(mlcfile)
mlc

ggtree(mlc) + geom_text(aes(x=branch, label=dN_vs_dS), color=&#39;blue&#39;, vjust=-.2)

#### 获取有用的信息
get.fields(mlc)

#### 指定需要调整的枝长

ggtree(mlc, branch.length = &quot;dN_vs_dS&quot;, aes(color=dN_vs_dS)) +
   scale_color_continuous(name=&#39;dN/dS&#39;, limits=c(0, 1.5),
                          oob=scales::squish, low=&quot;darkgreen&quot;, high=&quot;red&quot;)+
   theme_tree2(legend.position=c(.9, .5))

#### CODEML 的 rst以及 mlc文件

ml &lt;- read.codeml(crstfile, mlcfile)
ml
#### 
head(fortify(ml))

#### 读取 HYPHY文件并绘制进化树

nwk &lt;- system.file(&quot;extdata/HYPHY&quot;, &quot;labelledtree.tree&quot;, package=&quot;ggtree&quot;)
ancseq &lt;- system.file(&quot;extdata/HYPHY&quot;, &quot;ancseq.nex&quot;, package=&quot;ggtree&quot;)
tipfas &lt;- system.file(&quot;extdata&quot;, &quot;pa.fas&quot;, package=&quot;ggtree&quot;)
hy &lt;- read.hyphy(nwk, ancseq, tipfas)
hy

ggtree(hy) + geom_text(aes(x=branch, label=AA_subs), vjust=-.5)


##### 读取r8s生成的文件并绘制进化树
r8s &lt;- read.r8s(system.file(&quot;extdata/r8s&quot;, &quot;H3_r8s_output.log&quot;, package=&quot;ggtree&quot;))
ggtree(r8s, branch.length=&quot;TREE&quot;, mrsd=&quot;2014-01-01&quot;) + theme_tree2()

ggtree(get.tree(r8s), aes(color=.id)) + facet_wrap(~.id, scales=&quot;free_x&quot;)

##### 读取RAxML生成的bootstrap文件并绘制进化树

raxml_file &lt;- system.file(&quot;extdata/RAxML&quot;, &quot;RAxML_bipartitionsBranchLabels.H3&quot;,package=&quot;ggtree&quot;)
raxml &lt;- read.raxml(raxml_file)
ggtree(raxml) + geom_label(aes(label=bootstrap, fill=bootstrap)) + geom_tiplab() +
   scale_fill_continuous(low=&#39;darkgreen&#39;, high=&#39;red&#39;) + theme_tree2(legend.position=&#39;right&#39;)

##### 读取NHX New Hampshire eXtended文件并绘制进化树
nhxfile &lt;- system.file(&quot;extdata&quot;, &quot;ADH.nhx&quot;, package=&quot;ggtree&quot;)
nhx &lt;- read.nhx(nhxfile)
ggtree(nhx) + geom_tiplab() + geom_point(aes(color=S), size=5, alpha=.5) + 
   theme(legend.position=&quot;right&quot;) +
   geom_text(aes(label=branch.length, x=branch), vjust=-.5) + 
   xlim(NA, 0.3)

##### 读取PHYLIP文件并绘制进化树以及序列比对图
phyfile &lt;- system.file(&quot;extdata&quot;, &quot;sample.phy&quot;, package=&quot;ggtree&quot;)
phylip &lt;- read.phylip(phyfile)
phylip

ggtree(phylip) + geom_tiplab()

msaplot(phylip, offset=1)

##### jplace格式数据同时保存自定义数据

jpf &lt;- system.file(&quot;extdata/sample.jplace&quot;,  package=&quot;ggtree&quot;)
jp &lt;- read.jplace(jpf)
print(jp)
## get only best hit
get.placements(jp, by=&quot;best&quot;)

## get all placement
get.placements(jp, by=&quot;all&quot;)

########################################################################
############ 进化树合并 ### 分类单元匹配 ##################################
############ 作者讲的不太清楚 
beast_file &lt;- system.file(&quot;examples/MCC_FluA_H3.tree&quot;, package=&quot;ggtree&quot;)
beast_tree &lt;- read.beast(beast_file)

rst_file &lt;- system.file(&quot;examples/rst&quot;, package=&quot;ggtree&quot;)
mlc_file &lt;- system.file(&quot;examples/mlc&quot;, package=&quot;ggtree&quot;)
codeml_tree &lt;- read.codeml(rst_file, mlc_file)

merged_tree &lt;- merge_tree(beast_tree, codeml_tree)

merged_tree

#################################################################
#### 读取 jplace 文件， 并将保存在csv文件种的性状信息

tree &lt;- system.file(&quot;extdata&quot;, &quot;pa.nwk&quot;, package=&quot;ggtree&quot;)
data &lt;- read.csv(system.file(&quot;extdata&quot;, &quot;pa_subs.csv&quot;, package=&quot;ggtree&quot;),stringsAsFactor=FALSE)
print(tree)

outfile &lt;- tempfile()
write.jplace(tree, data, outfile)
jp &lt;- read.jplace(outfile)

ggtree(jp) + 
   geom_text(aes(x=branch, label=subs), color=&quot;purple&quot;, vjust=-1, size=3) + 
   geom_text(aes(label=gc), color=&quot;steelblue&quot;, hjust=-.6, size=3) +
   geom_tiplab()

#############################################################################
########## 绘制进化树
library(&quot;ggtree&quot;)
nwk &lt;- system.file(&quot;extdata&quot;, &quot;sample.nwk&quot;, package=&quot;ggtree&quot;)
tree &lt;- read.tree(nwk)

ggplot(tree, aes(x, y)) + geom_tree() + theme_tree()
ggtree(tree, color=&quot;firebrick&quot;, size=1, linetype=&quot;dotted&quot;)

### ggtree会自动将进化树转换为 ladderized， 如果要取消 ladderized， 则应该改为 ladderize
ggtree(tree, ladderize=FALSE)

### 不要枝长， 只查
ggtree(tree, branch.length=&quot;none&quot;)

########## 进化树显示的方式 ############

矩形 rectangular (by default)
偏斜 slanted
扇形/圆形 fan or circular

ggtree(tree) + ggtitle(&quot;(Phylogram) rectangular layout&quot;)
ggtree(tree, layout=&quot;slanted&quot;) + ggtitle(&quot;(Phylogram) slanted layout&quot;)
ggtree(tree, layout=&quot;circular&quot;) + ggtitle(&quot;(Phylogram) circular layout&quot;)

###### 只显示拓扑结构
### 矩形
ggtree(tree, branch.length=&#39;none&#39;) + ggtitle(&quot;(Cladogram) rectangular layout&quot;)

### 偏斜
ggtree(tree, layout=&quot;slanted&quot;, branch.length=&#39;none&#39;) + ggtitle(&quot;(Cladogram) slanted layout&quot;)

### 圆形
ggtree(tree, layout=&quot;circular&quot;, branch.length=&quot;none&quot;) + ggtitle(&quot;(Cladogram) circular layout&quot;)

##### 无根树
ggtree(tree, layout=&quot;unrooted&quot;) + ggtitle(&quot;unrooted layout&quot;)

#######################################################################################
########### Ultrametric Tree 绘图会自动添加标尺 ###################
ggtree(tree) + geom_treescale()

#### 更改标尺的长短颜色， 粗细 
ggtree(tree)+geom_treescale(x=0, y=12, width=6, color=&#39;red&#39;)

#################### 
ggtree(tree)+geom_treescale(fontsize=8, linesize=2, offset=-1)

###### 添加时间轴 依靠 theme_tree2()
ggtree(tree) + theme_tree2()

#########################################################################################
###### 节点以及分类单元的标识， 根据是否为 tiplabel以及node分别显示
ggtree(tree)+geom_point(aes(shape=isTip, color=isTip), size=3)

#### Node Point参数 以及 tippoint分别显示
p &lt;- ggtree(tree) + geom_nodepoint(color=&quot;#b5e521&quot;, alpha=1/4, size=10)
p + geom_tippoint(color=&quot;#FDAC4F&quot;, shape=8, size=3)

#### Tiplabel的显示
p + geom_tiplab(size=3, color=&quot;purple&quot;)

#### 圆形进化树的标签
ggtree(tree, layout=&quot;circular&quot;) + geom_tiplab(aes(angle=angle), color=&#39;blue&#39;)

#### 进化树tip label显示到branch上
p + geom_tiplab(aes(x=branch), size=3, color=&quot;purple&quot;, vjust=-0.3)

#### %&lt;% 若之前已经有ggtree object完成了进化树的绘制， 那么可以用 %&gt;% 将前一个进化树的属性转移到当前进化树中。 %&lt;% 的作用相当于word中的格式刷。 
p %&lt;% rtree(50)

#################################################################
######### ggtree中有两个主题 theme， theme_tree2() 和 theme_tree()
### theme_tree2 与 后者的区别在于 增加了时间坐标轴。 
### 无坐标轴
ggtree(rtree(30), color=&quot;red&quot;) + theme_tree()

### 有坐标轴
ggtree(rtree(30), color=&quot;red&quot;) + theme_tree2()

### 改变背景颜色
ggtree(rtree(30), color=&quot;red&quot;) + theme_tree(&quot;steelblue&quot;)

### 
ggtree(rtree(20), color=&quot;white&quot;) + theme_tree(&quot;#b5e521&quot;)

#################################################################
############# 显示多个进化树 ######################################
trees &lt;- lapply(c(10, 20, 40), rtree)
class(trees) &lt;- &quot;multiPhylo&quot;
ggtree(trees) + facet_wrap(~.id, scale=&quot;free&quot;) + geom_tiplab()

#################################################################
btrees &lt;- read.tree(system.file(&quot;extdata/RAxML&quot;, &quot;RAxML_bootstrap.H3&quot;, package=&quot;ggtree&quot;))
ggtree(btrees) + facet_wrap(~.id, ncol=10)


#################################################################
########### 显示bootstrap进化树作为背景 #################################
p &lt;- ggtree(btrees, layout=&quot;rectangular&quot;,   color=&quot;lightblue&quot;, alpha=.3)

best_tree &lt;- read.tree(system.file(&quot;extdata/RAxML&quot;, &quot;RAxML_bipartitionsBranchLabels.H3&quot;,package=&quot;ggtree&quot;))
df &lt;- fortify(best_tree, branch.length = &#39;none&#39;)
p + geom_tree(data=df, color=&#39;firebrick&#39;)

################################################################################
############# 进化树的操作 ##########################################

#### 对进化树操作之前， 必须要定位进化树内部的节点， 每一个节点都有一个顺序号
#### ggtree提供了显示内部节点号的函数

nwk &lt;- system.file(&quot;extdata&quot;, &quot;sample.nwk&quot;, package=&quot;ggtree&quot;)
tree &lt;- read.tree(nwk)
ggtree(tree) + geom_text2(aes(subset=!isTip, label=node), hjust=-.3) + geom_tiplab()

#### 用MRCA显示节点编号
MRCA(tree, tip=c(&#39;A&#39;, &#39;E&#39;))

########### 显示某一个节点下的整个类群 clade
p &lt;- ggtree(tree)
viewClade(p + geom_tiplab(), node=21)

########### 基于内部节点号， 划定clade， 按照clade划分颜色
tree &lt;- groupClade(tree, node=21)
ggtree(tree, aes(color=group, linetype=group))

##########  不同group分不同颜色显示， 显示tiplabel时， 不同的组别用不同的颜色表示
tree &lt;- groupClade(tree, node=c(21, 17))
ggtree(tree, aes(color=group, linetype=group)) + geom_tiplab(aes(subset=(group==2)))

########### 手工指定类群的分组，并且表示为不同的颜色 
cls &lt;- list(c1=c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;),
           c2=c(&quot;F&quot;, &quot;G&quot;, &quot;H&quot;),
           c3=c(&quot;L&quot;, &quot;K&quot;, &quot;I&quot;, &quot;J&quot;),
           c4=&quot;M&quot;)

#### s输入对象未 ggtree时
tree &lt;- groupOTU(tree, cls)
library(&quot;colorspace&quot;)
ggtree(tree, aes(color=group, linetype=group)) + geom_tiplab() +
    scale_color_manual(values=c(&quot;black&quot;, rainbow_hcl(4))) + theme(legend.position=&quot;right&quot;)

#### 输入对象为
p &lt;- ggtree(tree)
groupOTU(p, LETTERS[1:5]) + aes(color=group) + geom_tiplab() +scale_color_manual(values=c(&quot;black&quot;, &quot;firebrick&quot;))


##### groupOTU划分组
library(&quot;ape&quot;)
data(chiroptera)
groupInfo &lt;- split(chiroptera$tip.label, gsub(&quot;_\w+&quot;, &quot;&quot;, chiroptera$tip.label))
chiroptera &lt;- groupOTU(chiroptera, groupInfo)
ggtree(chiroptera, aes(color=group), layout=&#39;circular&#39;) + geom_tiplab(size=1,aes(angle=angle))


##### 类群折叠与展开
cp &lt;- ggtree(tree) %&gt;% collapse(node=21)

### 折叠节点号为21的类群
cp + geom_point2(aes(subset=(node == 21)), size=5, shape=23, fill=&quot;steelblue&quot;)

### 展开
cp %&gt;% expand(node=21)

### 折叠以及展开多个节点
p1 &lt;- ggtree(tree)
p2 &lt;- collapse(p1, 21) + geom_point2(aes(subset=(node==21)), size=5, shape=23, fill=&quot;blue&quot;)
p3 &lt;- collapse(p2, 17) + geom_point2(aes(subset=(node==17)), size=5, shape=23, fill=&quot;red&quot;)
p4 &lt;- expand(p3, 17)
p5 &lt;- expand(p4, 21)

multiplot(p1, p2, p3, p4, p5, ncol=5)


#### 类群的缩放
multiplot(ggtree(tree) + geom_hilight(21, &quot;steelblue&quot;),
         ggtree(tree) %&gt;% scaleClade(21, scale=0.3) + geom_hilight(21, &quot;steelblue&quot;),
         ncol=2)

#### 指定节点编号， 高亮某一个类群
ggtree(tree) + geom_hilight(21, &quot;steelblue&quot;)

#### 类群clade旋转180度 (此例子不能运行)
tree &lt;- groupClade(tree, c(21, 17))
### p &lt;- ggtree(tree, aes(color=group)) + scale_color_manual(values=c(&quot;black&quot;, &quot;firebrick&quot;, &quot;steelblue&quot;))
#### p2 &lt;- rotate(p, 21) %&gt;% rotate(p, 17)
multiplot(p, p2, ncol=2)

########################################################################
##### 两个分类群位置互换
multiplot(p, flip(p, 17, 21), ncol=2)

############################################################################
############################################################################
##### 进化树
beast_file &lt;- system.file(&quot;examples/MCC_FluA_H3.tree&quot;, package=&quot;ggtree&quot;)
beast_tree &lt;- read.beast(beast_file)
beast_tree


##### 绘制进化树
p1 &lt;- ggtree(beast_tree, mrsd=&#39;2013-01-01&#39;) + theme_tree2() +
   ggtitle(&quot;Divergence time&quot;)
p2 &lt;- ggtree(beast_tree, branch.length = &#39;rate&#39;) + theme_tree2() +
   ggtitle(&quot;Substitution rate&quot;)
multiplot(p1, p2, ncol=2)

###### 局部放大某一个分类群 clade
library(&quot;ape&quot;)
data(chiroptera)
library(&quot;ggtree&quot;)
gzoom(chiroptera, grep(&quot;Plecotus&quot;, chiroptera$tip.label))

###### 局部放大某分类群
groupInfo &lt;- split(chiroptera$tip.label, gsub(&quot;_\w+&quot;, &quot;&quot;, chiroptera$tip.label))
chiroptera &lt;- groupOTU(chiroptera, groupInfo)
p &lt;- ggtree(chiroptera, aes(color=group)) + geom_tiplab() + xlim(NA, 23)
gzoom(p, grep(&quot;Plecotus&quot;, chiroptera$tip.label), xmax_adjust=2)

###### 各分支按照条件设色
ggtree(beast_tree, aes(color = rate)) +
   scale_color_continuous(low=&#39;darkgreen&#39;, high=&#39;red&#39;) +
   theme(legend.position=&quot;right&quot;)

##### 标注某一个clade， 在右侧画竖线
set.seed(2015-12-21)
tree = rtree(30)
p &lt;- ggtree(tree) + xlim(NA, 6)

p + geom_cladelabel(node=45, label=&quot;test label&quot;) + 
   geom_cladelabel(node=34, label=&quot;another clade&quot;) 

##### 右侧标注用的竖线可以对齐
p + geom_cladelabel(node=45, label=&quot;test label&quot;, align=TRUE, offset=.5) +
   geom_cladelabel(node=34, label=&quot;another clade&quot;, align=TRUE, offset=.5)

##### 改变标注竖线的颜色
p+geom_cladelabel(node=45, label=&quot;test label&quot;, align=T, color=&#39;red&#39;) +
   geom_cladelabel(node=34, label=&quot;another clade&quot;, align=T, color=&#39;blue&#39;)

##### 旋转标注类群的文字
p+geom_cladelabel(node=45, label=&quot;test label&quot;, align=T, angle=270, hjust=&#39;center&#39;,offset.text=.5) + geom_cladelabel(node=34, label=&quot;another clade&quot;, align=T, angle=45)     

##### 改变标注竖线的粗细， 以及文字的大小
p+geom_cladelabel(node=45, label=&quot;test label&quot;, align=T, angle=270, hjust=&#39;center&#39;,offset.text=.5, barsize=1.5) +
   geom_cladelabel(node=34, label=&quot;another clade&quot;, align=T, angle=45, fontsize=8) 

##### 为文字添加边框， 并设置文本框的背景颜色
p+ geom_cladelabel(node=34, label=&quot;another clade&quot;, align=T, geom=&#39;label&#39;, fill=&#39;lightblue&#39;) 

########################################################################
################# 对类群进行高亮显示 ######################################
nwk &lt;- system.file(&quot;extdata&quot;, &quot;sample.nwk&quot;, package=&quot;ggtree&quot;)
tree &lt;- read.tree(nwk)
ggtree(tree) + geom_hilight(node=21, fill=&quot;steelblue&quot;, alpha=.6) +
   geom_hilight(node=17, fill=&quot;darkgreen&quot;, alpha=.6)

#### 圆形树的类群高亮
ggtree(tree, layout=&quot;circular&quot;) + geom_hilight(node=21, fill=&quot;steelblue&quot;, alpha=.6) +
   geom_hilight(node=23, fill=&quot;darkgreen&quot;, alpha=.6)

#########################################################################
#### 标注 bootstrap数值 
#### 用ape生成一个NJ树， 并且进行bootstrap， 将bootstrap的结果在NJ树的节点上显示。 

library(ape)
data(woodmouse)
d &lt;- dist.dna(woodmouse)
tr &lt;- nj(d)
bp &lt;- boot.phylo(tr, woodmouse, function(xx) nj(dist.dna(xx)))

##### 
tree &lt;- apeBoot(tr, bp)  ### merge phylo and output of boot.phylo to &#39;apeBootstrap&#39; object
ggtree(tree) + geom_label(aes(label=bootstrap)) + geom_tiplab()


##### 对phangorn生成进化树的标注
library(phangorn)
treefile &lt;- system.file(&quot;extdata&quot;, &quot;pa.nwk&quot;, package=&quot;ggtree&quot;)
tre &lt;- read.tree(treefile)
tipseqfile &lt;- system.file(&quot;extdata&quot;, &quot;pa.fas&quot;, package=&quot;ggtree&quot;)
tipseq &lt;- read.phyDat(tipseqfile,format=&quot;fasta&quot;)
fit &lt;- pml(tre, tipseq, k=4)
#### fit是设定条件生成的最优进化树
fit &lt;- optim.pml(fit, optNni=FALSE, optBf=T, optQ=T,
                optInv=T, optGamma=T, optEdge=TRUE,
                optRooted=FALSE, model = &quot;GTR&quot;)

#### 将pml格式的数据转换为 ggtree能够识别的类型
phangorn &lt;- phyPML(fit, type=&quot;ml&quot;)
ggtree(phangorn) + geom_text(aes(x=branch, label=AA_subs, vjust=-.5))

#### ggtree可以读取如下软件生成的进化树， 并且同时保存这些软件输出结果关于进化速率等相应的信息
BEAST
EPA
HYPHY
PAML
PHYLDOG
pplacer
r8s
RAxML
RevBayes

########################################################################
######## 将性状信息与进化树匹配绘图 ###############

nwk &lt;- system.file(&quot;extdata&quot;, &quot;sample.nwk&quot;, package=&quot;ggtree&quot;)
tree &lt;- read.tree(nwk)
p &lt;- ggtree(tree)

##### 生成随机数据
dd &lt;- data.frame(taxa  = LETTERS[1:13], 
                place = c(rep(&quot;GZ&quot;, 5), rep(&quot;HK&quot;, 3), rep(&quot;CZ&quot;, 4), NA),
                value = round(abs(rnorm(13, mean=70, sd=10)), digits=1))
## you don&#39;t need to order the data
## data was reshuffled just for demonstration
dd &lt;- dd[sample(1:13, 13), ]
row.names(dd) &lt;- NULL

##### 数据框匹配字符
##### %&lt;+% 运算符的要求
##### 左侧为进化树
##### 右侧为 data.frame, 要求是该进化树的第一列种的物种名必须能与进化树的tip.label匹配上。 

p &lt;- p %&lt;+% dd + geom_tiplab(aes(color=place)) + 
      geom_tippoint(aes(size = value, shape = place, color = place), alpha = 0.25)
      
p + theme(legend.position=&quot;right&quot;)

##### 将采集地点以及性状值写在枝长上
p + geom_text(aes(color=place, label=place), hjust=1, vjust=-0.4, size=3) +
 geom_text(aes(color=place, label=value), hjust=1, vjust=1.4, size=3)

########################################################################
########################################################################
########################################################################
####################### 在进化树右侧绘制热图 ###############################

beast_file &lt;- system.file(&quot;examples/MCC_FluA_H3.tree&quot;, package=&quot;ggtree&quot;)
beast_tree &lt;- read.beast(beast_file)

genotype_file &lt;- system.file(&quot;examples/Genotype.txt&quot;, package=&quot;ggtree&quot;)
genotype &lt;- read.table(genotype_file, sep=&quot;t&quot;, stringsAsFactor=F)
head(genotype)

p &lt;- ggtree(beast_tree, mrsd=&quot;2013-01-01&quot;) + geom_treescale(x=2008, y=1)
p &lt;- p + geom_tiplab(size=3)
gheatmap(p, genotype, offset = 2, width=0.5)

########################################################################
#### scale_x_ggtree() 保证右侧矩阵的文字说明能正常显示。 
p &lt;- ggtree(beast_tree, mrsd=&quot;2013-01-01&quot;) + geom_tiplab(size=3, align=TRUE) + theme_tree2()
pp &lt;- (p + scale_y_continuous(expand=c(0, 0.3))) %&gt;%
   gheatmap(genotype, offset=4, width=0.5, colnames=FALSE) %&gt;%
       scale_x_ggtree()
pp + theme(legend.position=&quot;right&quot;)

######################## msaplot ###### 
##### 进化树 以及 fasta比对矩阵 
fasta &lt;- system.file(&quot;examples/FluA_H3_AA.fas&quot;, package=&quot;ggtree&quot;)
msaplot(ggtree(beast_tree), fasta) 

######################## 扇形的 msaplot #####
msaplot(ggtree(beast_tree), fasta, window=c(150, 200)) + coord_polar(theta=&#39;y&#39;)

######################## 在进化树的总图上高亮显示某一个clade： geom_hilight
######################## 并且在右侧的大图中放大该clade viewClade subview
set.seed(2016-01-04)
tr &lt;- rtree(30)
tr &lt;- groupClade(tr, node=45)
p &lt;- ggtree(tr, aes(color=group)) + geom_tippoint()
p1 &lt;- p + geom_hilight(node=45)
p2 &lt;- viewClade(p, node=45) + geom_tiplab()
subview(p2, p1+theme_transparent(), x=2.3, y=28.5)


#############################################################################
########## 用inset为内部节点添加直方图， 以显示每个节点在性状上所占比例  ##############
#############################################################################

set.seed(2015-12-31)
tr &lt;- rtree(15)
p &lt;- ggtree(tr)

a &lt;- runif(14, 0, 0.33)
b &lt;- runif(14, 0, 0.33)
c &lt;- runif(14, 0, 0.33)
d &lt;- 1 - a - b - c
dat &lt;- data.frame(a=a, b=b, c=c, d=d)
## input data should have a column of `node` that store the node number 
### 数据必须有一列名为node， 并且值为节点数
dat$node &lt;- 15+1:14

## cols parameter indicate which columns store stats (a, b, c and d in this example)
## cols表示dat的1:4列储存了用于绘图的数据
bars &lt;- nodebar(dat, cols=1:4)

inset(p, bars)

## 柱状图的大小和颜色
inset(p, bars, width=.03, height=.06)

### 柱状图的排列方式， 改为并排排列
bars2 &lt;- nodebar(dat, cols=1:4, position=&#39;dodge&#39;,
                color=c(a=&#39;blue&#39;, b=&#39;red&#39;, c=&#39;green&#39;, d=&#39;cyan&#39;))
p2 &lt;- inset(p, bars2, x=&#39;branch&#39;, width=.03, vjust=-.3)
print(p2)


##############################################################
### 节点上的饼图 

pies &lt;- nodepie(dat, cols=1:4, alpha=.6)
inset(p, pies) 

inset(p, pies, hjust=-.06) ### 饼图向右平移

##############################################################
#### 同时用 pie和bar标注内部节点

pies_and_bars &lt;- bars2
pies_and_bars[9:14] &lt;- pies[9:14]
inset(p, pies_and_bars)

##############################################################
##### 用 inset函数用tip添加对应的箱线图 boxplot， 以展示数据分布

d &lt;- lapply(1:15, rnorm, n=100)
ylim &lt;- range(unlist(d))
bx &lt;- lapply(d, function(y) &#123;
   dd &lt;- data.frame(y=y)
   ggplot(dd, aes(x=1, y=y)) + geom_boxplot() + ylim(ylim) + theme_inset()
&#125;)
names(bx) &lt;- 1:15
inset(p, bx, width=.03, height=.1, hjust=-.05)


#########################################################################
### 混合标注， 未能成功
### p2 &lt;- inset(p, bars2, x=&#39;branch&#39;, width=.03, vjust=-.4)
### p2 &lt;- inset(p2, pies, x=&#39;branch&#39;, vjust=.4)
### bx2 &lt;- lapply(bx, function(g) g+coord_flip())
### inset(p2, bx2, width=.2, height=.03, vjust=.04, hjust=p2datadatax[1:15]-4) + xlim(NA, 4.5)


########################################################################
###### ggplot统计与进化树绘制 ################ 
tr &lt;- rtree(30)
df &lt;- fortify(tr)
df$tipstats &lt;- NA
d1 &lt;- df
d2 &lt;- df
d2$tipstats[d2$isTip] &lt;- abs(rnorm(30))
d1$panel &lt;- &#39;Tree&#39;
d2$panel &lt;- &#39;Stats&#39;
d1$panel &lt;- factor(d1$panel, levels=c(&quot;Tree&quot;, &quot;Stats&quot;))
d2$panel &lt;- factor(d2$panel, levels=c(&quot;Tree&quot;, &quot;Stats&quot;))

p &lt;- ggplot(mapping=aes(x=x, y=y)) + facet_grid(.~panel, scale=&quot;free_x&quot;) + theme_tree2()
p+geom_tree(data=d1) + geom_point(data=d2, aes(x=tipstats)) 

########################################################################
##### 从 phylopic数据库上下载剪影图像， 并标在进化树上

pp &lt;- ggtree(tree) %&gt;% phylopic(&quot;79ad5f09-cf21-4c89-8e7d-0c82a00ce728&quot;, color=&quot;steelblue&quot;,alpha = .3)
print(pp)
</code></pre>
<p>参考：</p>
<p>Yu, G., Smith, D. K., Zhu, H., Guan, Y., &amp; Lam, T. T. Y. (2017). ggtree: an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data. <em>Methods in Ecology and Evolution</em>, <em>8</em>(1), 28-36</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://helixcn.github.io/2016/04/10/2016-4-10-ggtree/" data-id="ckmq42als00e21k845o7shay6" data-title="在R中绘制进化树：ggtree学习笔记" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">可视化</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2016-3-23-krig" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2016/03/22/2016-3-23-krig/" class="article-date">
  <time class="dt-published" datetime="2016-03-22T09:09:54.000Z" itemprop="datePublished">2016-03-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2016/03/22/2016-3-23-krig/">克里格空间插值Kriging及其在R的实现</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>克里格是一种空间插值的方法. 克里格插值, 是法国地统计学家 Georges Matheron (1930-2000)基于南非工程师Danie G. Krige (1919-2013)的硕士论文发展起来的方法. D. Krige硕士论文研究的问题是如何根据金矿探测点的含金量推断含金量在空间上的变化. </p>
<p>所谓空间插值, 就是通过一些列具有空间关系的点数据, 来推广到面上数据的方法.</p>
<p>除了克里格方法之外, 从点数据推断面的数据变化, 还有线性插值, 距离反平方插值等多种方法. 而克里格其实也是一类方法的通称, 它包括普通克里格, 通用克里格, 通用模块克里格等等. 但是克里格方法可以求得模型的无偏估计,并且方便得获得预测的误差, 这对于其他方法来讲常常难易实现. </p>
<p>这里只简单介绍用gstat程序包实现普通克里格, 以及通过一套模拟数据获得高程图.除了gstat程序包外, geoR程序包以及fields程序包也提供了克里格插值方法.</p>
<pre><code class="R">#### 首先生成一套模拟数据simdat, 通过Volcano数据随机提取1000个点, 用raster的extract函数提取

library(raster)
rrr &lt;- raster(t(volcano), xmn=0, xmx= 870 , ymn=0, ymx=610)
x11()
plot(rrr, col = terrain.colors(100))

set.seed(12345)
loc &lt;- data.frame(x = round(runif(1000, min = 0, max = 870), 2), y = round(runif(1000,min = 0, max = 610), 2))
value &lt;- extract(rrr, loc)
simdat &lt;- data.frame(loc, alt = value) ### The simulated data


#### Krig准备工作开始, 导入程序包
library(sp)
library(gstat)

#### simdat需要转换为sp格式, 需要指定坐标
coordinates(simdat) &lt;- ~x+y
### bubble(simdat, &quot;alt&quot;)
spplot(simdat, &quot;alt&quot;) ### 查看每个点的值 

#### 创建克里格所用的网格, 20m方格的中心位置
xgrid &lt;- seq(ceiling(min(simdat$x)), floor(max(simdat$x)), by = 20) 
ygrid &lt;- seq(ceiling(min(simdat$y)), floor(max(simdat$y)), by = 20) 
basexy &lt;- expand.grid(xgrid, ygrid)
#### plot(y ~ x, basexy)
colnames(basexy) &lt;- c(&quot;x&quot;, &quot;y&quot;)
coordinates(basexy) &lt;- ~x+y
gridded(basexy) &lt;- TRUE

### 因Kriging需要基于 Variogram以及相应的模型.Variogram横轴是距离, 纵轴是方差. 做模型拟合时, 应先查看 Variogram. Variogram根据点与点之间的距离, 分成若干段, 并计算每一段的方差, 再通过拟合Variogram模型, 获得Krig所需要的参数. 拟合Variogram模型时, 需要提供模型的初始值,再进行迭代优化, 否则很难获得模型的准确参数. 

######### 若所进行的是普通克里格插值, 则需要插值的变量只与自身取样点的距离相关,用公式表示为 alt~1, 这里的~1是variogram的规定 (参见 ?variogram). 
vgm1 &lt;- variogram(alt~1, simdat)
plot(vgm1, plot.numbers = TRUE) 

### variogram的模型常包括
### Circular
### Spherical
### Exponential
### Gaussian
### Linear
### gstat程序包提供的模型可以通过 vgm() 查看

m &lt;- fit.variogram(vgm1,vgm(.01,&quot;Sph&quot;,100,300))
plot(vgm1, model=m)
</code></pre>
<h3 id="在拟合gm模型时-需要提供以下几个参数的初始值"><a href="#在拟合gm模型时-需要提供以下几个参数的初始值" class="headerlink" title="在拟合gm模型时, 需要提供以下几个参数的初始值"></a>在拟合gm模型时, 需要提供以下几个参数的初始值</h3><ul>
<li>psill: partial sill</li>
<li>model: 模型的类型</li>
<li>range: 范围</li>
<li>nugget: 块金值</li>
</ul>
<p>图1 Range, Sill, Partial Sill, and Nugget of the Variogram</p>
<p>各参数的几何意义如图一所示. 初始值要通过在variogram的图中读取, 尽量接近真实值, 这样后续的迭代才会成功.</p>
<p>例如以下例子中: </p>
<ul>
<li>.01 为 psill</li>
<li>“Sph” 为球状模型</li>
<li>300 为范围</li>
<li>nugget为 块金值. </li>
</ul>
<pre><code class="R">### 设定vgm模型的初始值
m &lt;- vgm(.01,&quot;Sph&quot;,300, 0.2)

### 进行克里格
krige_res &lt;- krige(alt~1, simdat, basexy, model = m)

### 查看克里格插值的结果
spplot(krige_res, zcol = &quot;var1.pred&quot;, main = &quot;Predictions of altitude based on the randomly sampled data&quot;, col.regions = terrain.colors(100))
</code></pre>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考:"></a>参考:</h1><p><a target="_blank" rel="noopener" href="http://planet.botany.uwc.ac.za/nisl/GIS/spatial/images/pic024.jpg">http://planet.botany.uwc.ac.za/nisl/GIS/spatial/images/pic024.jpg</a><br><a target="_blank" rel="noopener" href="http://webhelp.esri.com/arcgisdesktop/9.3/index.cfm?TopicName=How%20Krige%20and%20Variogram%20work">http://webhelp.esri.com/arcgisdesktop/9.3/index.cfm?TopicName=How%20Krige%20and%20Variogram%20work</a></p>
<p><a target="_blank" rel="noopener" href="http://geostat-course.org/**system**/files/lewis_tutortPM.pdf">http://geostat-course.org/**system**/files/lewis_tutortPM.pdf</a><br>苏姝,林爱文,刘庆华 (2004) 普通 Kriging 法在空间内插中的运用 江南大学学报 (自然科学版) 3(1):18-21</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://helixcn.github.io/2016/03/22/2016-3-23-krig/" data-id="ckmq42ajg00821k84g8sj8n90" data-title="克里格空间插值Kriging及其在R的实现" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BB%9F%E8%AE%A1/" rel="tag">统计</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2016-2-1-advicer" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2016/01/31/2016-2-1-advicer/" class="article-date">
  <time class="dt-published" datetime="2016-01-31T08:49:54.000Z" itemprop="datePublished">2016-01-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2016/01/31/2016-2-1-advicer/">R编程的一些规则与建议</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>使用R软件进行统计分析, 必须要接触R脚本. R脚本是保存了R代码的文本文件, 一般以.R为扩展名. </p>
<p>要高效得进行代码的编写和调试, 需要一个好的编辑器或者好的编程环境. 当然, 每个人都可以使用最简单的文本编辑, 如Windows Notepad 或者Rgui所提供的文本编辑工具, 但是要避免使用MS word等文档编辑器编辑R脚本. </p>
<p>编辑器最好能符合以下要求: </p>
<ol>
<li><p>等宽字体, 如Consolas, Courier New 等, Consolas配合微软雅黑字体是不错的选择.</p>
</li>
<li><p>代码高亮显示, 意思是对字符串, 数字, 以及语言的关键词, 以及注释部分 分别用不同颜色显示出来.</p>
</li>
<li><p>括号配对, 小括号, 中括号以及花括号成对匹配时同时高亮显示. </p>
</li>
<li><p>提供良好的 正则表达式匹配, 以及特殊字符匹配, 如针对 n, t, r等特殊字符的匹配, 以及替换. </p>
</li>
<li><p>列模式, 即同时对多个列进行输入, 或者编辑. </p>
</li>
<li><p>编码转换工具, 如UTF-8编码转ASCII, GBK18030, BIG5等等. </p>
</li>
<li><p>大小写转换工具</p>
</li>
<li><p>快速运行功能, 如一键运行代码. </p>
</li>
<li><p>显示行号</p>
</li>
<li><p>具有导出为html功能或者Latex, 或RTF等功能</p>
</li>
<li><p>字体大小能够灵活控制, 一般通过按住Contrl并转动鼠标滚轮, 即可调整显示字体的大小. </p>
</li>
</ol>
<p>在众多的编辑器中, 符合这种要求的恐怕不是很多. 目前比较理想的, Windows下是Notepad++, Linux下则是Geany, MacOS下的编辑器则不太了解. 试用过gedit, Kate, 它们都提供了R的高亮, 但是似乎还是不够灵活. 甚至Rstudio这样专门为R设计的IDE, 还是有很多功能没有实现, 所以并不能让人十分满意. </p>
<p>说到编程习惯, 难免老生常谈. 例如, 什么要缩进, 要提供详细的注释等等. 这和其他编程语言并无区别. 然而R毕竟还是有自己的特点, 所以这里还是列出来一些经验:  </p>
<p>在开始分析前, 一定要先简要查看数据的分布, 以确定所选择的统计方法. 在开始编写函数前, 应该对要数据的数据格式, 以及输出的数据有清楚的理解. </p>
<ol>
<li><p>所有的R脚本, 以应R作为扩展名, 这样编辑器打开时能够默认是R语言的高亮, 从而节省选择语言高亮的时间. </p>
</li>
<li><p>R脚本建议以 #### 开头, 然后写清楚 该脚本的标题, 作者, 日期, 联系方式等, 这样, 日后查看脚本这部分注释代码, 有很好的参考作用. </p>
</li>
<li><p>第一句写 setwd(), 指定工作目录. 任何一个任务, 都应该单独创建一个文件夹, 其中放数据, R脚本, 以及运行的结果等</p>
</li>
<li><p>随后是加载该脚本需要用到的程序包 如 <code>library(vegan)</code>, 每一行只加载一个程序包, 直到所有用到的程序包全部加载. </p>
</li>
<li><p>脚本中定义的函数要在加载程序包之后立即定义. </p>
</li>
<li><p>如果数据是保存在xls文件中的, 每个xls文件只保存一个data_sheet. xls文件尽量保存为csv文件, 再读取, 不要保存为txt文件, 因为read.csv()比read.table()要稳定很多. 如果数据是保存在xlsx文件中的, 尽量用 openxlsx程序包所提供的函数read.xlsx()读取数据. </p>
</li>
<li><p>变量的名称要具体,并且只用ASCII码字母, 要避免A,B,C,D,X等类似的变量名. 变量命名时, 尽量不要大小写混搭, 不同部分用下划线_分隔. 理想状态是, 即使不看注释, 只看变量的名称, 也可以知道变量的意义. </p>
</li>
<li><p>算法的关键部分, 要注释, 特别容易出错的地方也要注释. 但是注释不能滥用. 数据处理的名称, 还应该通过变量名体现出来. </p>
</li>
<li><p>缩写的函数要尽量简单明确, 以方便维护. </p>
</li>
<li><p>写函数时要善用 warning, stop等处理异常的函数, 以便规范数据输入. </p>
</li>
<li><p>要尽量学会 git, 以记录所有关键的更改. </p>
</li>
<li><p>一个R脚本, 拷贝到R console运行时, 应该能够全部自动运行, 中间不能再要求手动输入参数. </p>
</li>
<li><p>保存R生成的图像, 应该尽量用 tiff函数和dev.off()配合. 不要再用手动保存的方法. </p>
</li>
<li><p>生成R程序包骨架时, 用 <code>package.skeletons()</code>, 然后分别编写Rd的函数帮助文件. 很多投机取巧的办法编写R程序包只能让问题更加复杂. </p>
</li>
<li><p>为了简化绘图编程, 应该尽快掌握ggplot2程序包. </p>
</li>
<li><p>为了克服计算瓶颈, 应该学会C或者FORTRAN语言, 也可以运用Rcpp结合C++, 并用R调用</p>
</li>
<li><p>及时注意R的更新, 参考如 <a target="_blank" rel="noopener" href="https://github.com/qinwf/awesome-R">https://github.com/qinwf/awesome-R</a> 以及CRAN Task Views的动态. </p>
</li>
</ol>
<p>张金龙</p>
<p>2016年2月1日</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://helixcn.github.io/2016/01/31/2016-2-1-advicer/" data-id="ckmq42ajf00801k8499eyfd3g" data-title="R编程的一些规则与建议" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R%E7%BC%96%E7%A8%8B/" rel="tag">R编程</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2015-11-24-herbairum_diversity" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2015/11/24/2015-11-24-herbairum_diversity/" class="article-date">
  <time class="dt-published" datetime="2015-11-23T18:45:54.000Z" itemprop="datePublished">2015-11-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2015/11/24/2015-11-24-herbairum_diversity/">《标本馆与生物多样性研究》在浸会大学国际学院的讲座</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>2015年11月23日， 很荣幸应浸会大学Sisi老师的邀请，为她的学生们介绍植物标本馆在生物多样性中的作用。 </p>
<p>幻灯片 <a target="_blank" rel="noopener" href="http://blog.sciencenet.cn/home.php?mod=attachment&id=76660">The role of a herbarium in Biodiversity Studies.ppt</a></p>
<p>这里主要介绍了标本馆的工作流程， 标本的制作， 排列， 以及标本馆数据的应用。</p>
<p><a target="_blank" rel="noopener" href="http://image.sciencenet.cn/home/201511/24/104524c0vz9690c4icnix4.jpg"><img src="http://image.sciencenet.cn/home/201511/24/104524c0vz9690c4icnix4.jpg" alt="img"></a></p>
<p>浸会大学国际学院</p>
<p><a target="_blank" rel="noopener" href="http://www.cie.hkbu.edu.hk/main/index.php">http://www.cie.hkbu.edu.hk/main/index.php</a></p>
<p>(<a target="_blank" rel="noopener" href="https://upload.wikimedia.org/wikipedia/commons/d/d0/HK_Baptist_University_Shek_Mun_Campus.jpg">https://upload.wikimedia.org/wikipedia/commons/d/d0/HK_Baptist_University_Shek_Mun_Campus.jpg</a>)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://helixcn.github.io/2015/11/24/2015-11-24-herbairum_diversity/" data-id="ckmq42aj3006w1k84ec6yclpu" data-title="《标本馆与生物多样性研究》在浸会大学国际学院的讲座" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%A0%87%E6%9C%AC%E9%A6%86/" rel="tag">标本馆</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2015-11-6-sqlit3" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2015/11/05/2015-11-6-sqlit3/" class="article-date">
  <time class="dt-published" datetime="2015-11-05T08:04:54.000Z" itemprop="datePublished">2015-11-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2015/11/05/2015-11-6-sqlit3/">sqlite3 简明指南</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>sqlite3 是运行SQL语言的小型数据库软件,有着广泛的应用。本文是学习笔记，原文请参考 <a target="_blank" rel="noopener" href="http://zetcode.com/db/sqlite/">http://zetcode.com/db/sqlite/</a></p>
<pre><code class="sql">
--下载: https://www.sqlite.org/download.html

--开启数据库, 在terminal输入:

sqlite3 test.db

--开启帮助
.help

--读取 sql脚本
.read friends.sql

--查询有什么表格
.TABLE s

--显示一个表格的全部内容
SELECT * FROM Friends;

--设定各列之间的间隔
.separator

--不同的显示模式
.mode column
.headers on

--选出部分列
SELECT Name, Title FROM Authors NATURAL JOIN Books;

--显示不同列时的宽度
.width 1518

--显示打印的属性
.show

--显示表格的属性
.schema Cars

--更改 调用命令的前缀
.prompt &quot;&gt; &quot;&quot;. &quot;

--从 Terminal 运行 sqlite
sqlite3 test.db &quot;SELECT * FROM Cars;&quot;

--导出数据
--1. 指名文件
.output cars2.sql
--2. 导出sql脚本
.dump Cars

--.sqlite_history 文件
位置 /home/jinlong
tail -5~/.sqlite_history

--.sqliterc 文件, 内容为纯文本,可以保存sqlite的配置命令, 位置
/home/jinlong

每次sqlite3启动时,会自动加载其中的sqlite命令

--显示帮助
sqlite3 --help

--进入sqlite3时，设定相应的参数
sqlite3 -echo -line -noheader test.db

--显示版本
sqlite3 -version

--以html的格式显示
sqlite3 -html test.db

----#####################
---数据库的创建
CREATE 
--任何一个field,有如下几种类型

--NULL — The value is a NULL value
--INTEGER — a signed integer
--REAL — a floating point value
--TEXT — a text string
--BLOB — a blob of data

---创建一个名为 Testing的表, 包含Id一列, 为整数类型
CREATE TABLE Testing(Id INTEGER);

-- 查看创建Testing的代码
.schema Testing

-- 若Tesing已经存在, 则再次创建会出错
CREATE TABLE Testing(Id INTEGER);

-- 为了减少这种错误, 可以用 IF NOT EXISTS 检查.
CREATE TABLE IF NOT EXISTS Testing(Id INTEGER);

-- 从其他数据生成表格
CREATE TABLE Cars2 AS SELECT * FROM Cars;

--查看现有数据库名
.databases

--有多个数据库时,需要在命令中指定要更改的数据库

ATTACH DATABASE &#39;test2.db&#39; AS &#39;test2&#39;; -- ### 可先在sqlite中更改数据库的名称
CREATE TABLE test2.Cars(Id INTEGER PRIMARY KEY, Name TEXT, Price INTEGER);
INSERT INTO test2.Cars VALUES(1,&#39;Porsche&#39;,107699);
SELECT * FROM main.Cars WHERE Id=1;

-- 临时数据库, 其中的数据表不会显示. 临时数据库的名称为 temp

CREATE TEMPORARY TABLE Cars(Id INTEGER PRIMARY KEY, Name TEXT, Price INTEGER);
INSERT INTO temp.Cars VALUES(1,&#39;Kia&#39;,24300);
.databases

--删除表格
DROP 

--查看表格
.TABLE s
DROP TABLE Testing;
--如果 Testing表格不存在, 而用DROP则会出错.

--为了排除这种错误, 一般改为
DROP TABLE IF EXISTS Testing;

--删除某一个数据库中的数据表
DROP TABLE IF EXISTS test2.Cars;

--###########################################
-- ALTER
-- 对表格的更改

CREATE TABLE Names(Id INTEGER, NameTEXT);

--表格改名
ALTER TABLE Names RENAME TO NamesOfFriends;
.schema NamesOfFriends

--为表格中增加一列
ALTER TABLE NamesOfFriends ADD COLUMN Email TEXT;
.schema NamesOfFriends

---########################################
--- sqlite语法规则

SELECT 3,&#39;Wolf&#39;,34.5;
.null value NULL

SELECT NULL;

---二进制大型物件 Binary Large Object (BLOB)
SELECT x&#39;345eda2348587aeb&#39;;

---###### sqlite中的 运算符
--- Arithmetic operators
--- Boolean operators
--- Relational operators
--- Bitwise operators
--- Other operators

--- ||
--- * / %
--- + -
--- &lt;&lt; &gt;&gt; &amp; |
--- &lt; &lt;= &gt; &gt;=
--- = == != &lt;&gt; IS IN LIKE GLOB BETWEEN
--- AND 
--- OR

--取反字符
SELECT -(3-44);
--- unary prefixoperators:
--- - + ~ NOT

--- 数值运算
SELECT 3 * 3/9;
SELECT 3 + 4 - 1 + 5;
SELECT 11 % 3;

---逻辑运算符
SELECT 1 AND 1, 0 AND 1, 1 AND 0, 0 AND 0 ;
SELECT 3=3 AND 4=4;
SELECT 0 OR 1,1 OR 0, 1 OR 1,0 OR 1;
SELECT NOT 1, NOT 0;
SELECT NOT (3=3);


--- 判断
--- Symbol Meaning
--- &lt; strictly less than
--- &lt;= less than or equal to
--- &gt; greater than
--- &gt;= greater than or equal to
--- = or == equal to
--- != or &lt;&gt; not equal to

SELECT 3 * 3==9, 9=9;
SELECT 3 &lt;4, 3&lt;&gt;5, 4&gt;=4, 5!=5;

---位运算, 针对二进制的运算

--- bitwise and operator &amp;,

SELECT 6 &amp; 3;
SELECT 3 &amp; 6;

--- bitwise or operator|

--- bitwise sh IF t &lt;&lt; &gt;&gt;

--- 取反
--- bitwise negation operator
SELECT ~7;

--- 其他运算符
--- ||字符串连接符
--- IN判断某个字符是否在一个向量中

--例如 
SELECT &#39;Tom&#39; IN (&#39;Tom&#39;,&#39;Frank&#39;,&#39;Jane&#39;);
---例如
SELECT * FROM Cars WHERE Name IN(&#39;Audi&#39;,&#39;Hummer&#39;);

---LIKE, 配合 WHERE , 用正则表达式筛选
SELECT * FROM Cars WHERE Name LIKE&#39;Vol%&#39;;

--- 特定字符数的字符筛选
SELECT * FROM Cars WHERE Name LIKE&#39;____&#39;;

--- GLOB, 类似于 Like, 但是区分大小写, 同时识别UNIX字符
SELECT * FROM Cars WHERE Name GLOB &#39; * en&#39;;
SELECT * FROM Cars WHERE Name GLOB &#39;????&#39;;---四个字符
AND
BETWEEN
SELECT * FROM Cars WHERE Price BETWEEN 20000 AND 55000;

--- 运算符的优先级
--- unary + - ~ NOT
--- ||
--- * / %
--- + -
--- &lt;&lt; &lt;&gt; &amp; |
--- &lt; &lt;= &gt; &gt;=
--- = == != &lt;&gt; IS IN LIKE GLOB BETWEEN
--- AND 
--- OR

---同一级别运算符的顺序-
---从左至右
SELECT 9/3 * 3;
---- 从左至右的运算符包括
---- Arithmetic, boolean, relational, and bitwise operators are all left to right associated.


--- 数据的插入, 更新和删除
DROP TABLE IF EXISTS Cars;
CREATE TABLE Cars(Id INTEGER PRIMARY KEY, Name TEXT, Price INTEGER DEFAULT &#39;Not available&#39;);
INSERT INTO Cars(Id, Name, Price) VALUES (1,&#39;Audi&#39;,52642);
INSERT INTO Cars(Name, Price) VALUES (&#39;Mercedes&#39;,57127);
SELECT * FROM Cars;
--- ### 设定为 INTEGER PRIMARY KEY 之后, 插入数据时, 可以忽略, 数据库会为新纪录自动增加一个Id

---若未能在INSERT 时给出各列名称, 则需要按照长度提供所有值
INSERT INTO Cars VALUES (3, &#39;Skoda&#39;, 9000);

--- 显示 NULL as NULL
.nullvalue NULL

SELECT * FROM Cars WHERE Id=4;

--- 对于已经有primary key条目的插入
INSERT INTO Cars VALUES(4,&#39;Volvo&#39;,29000);
INSERT OR REPLACE INTO Cars VALUES(4,&#39;Volvo&#39;,29000);
SELECT * FROM Cars WHERE Id=4;

--- 如果插入数据不成功， 会提示fail
INSERT OR FAIL INTO Cars VALUES(4,&#39;Bentley&#39;,350000);

--- 不会提示任何信息
INSERT OR IGNORE INTO Cars VALUES(4,&#39;Bentley&#39;,350000);

--- sqlite 3.7.11 之后, 可以同时插入多行
CREATE TABLE Ints(Id INTEGER PRIMARY KEY, Val INTEGER);

INSERT INTO Ints(Val) VALUES(1),(3),(5),(6),(7),(8),(6),(4),(9);
CREATE TABLE Cars2(Id INTEGER PRIMARY KEY, Name TEXT, Price INTEGER);
INSERT INTO Cars2 SELECT * FROM Cars;

---############################################
--- ####### DELETE 删除部分数据

DELETE FROM Cars2 WHERE Id=1; 
SELECT * FROM Cars2; -- 删除Cars2中的全部内容
DELETE FROM Cars2;

SELECT Count(Id)AS&#39;# of cars&#39;FROM Cars2;
.read cars.sql
SELECT * FROM Cars;
DELETE FROM Cars LIMIT5;
SELECT * FROM Cars;

----############################################
---- ####### Update,按照条件对数据进行修改
.read cars.sql
UPDATE Cars SET Name=&#39;Skoda Octavia&#39; WHERE Id=3;
SELECT * FROM Cars WHERE Id=3;

----###########################################
---- #### SELECT 的使用
---- ### 显示全部表格
SELECT * FROM Cars;

----### 选择特定的列
SELECT Name, Price FROM Cars;

---- ### 查询结果, 但是改查询结果的名
SELECT Name, Price AS &#39;Price of car&#39;FROM Cars;

---- ### 显示部分数据
SELECT * FROM Cars LIMIT 4;

SELECT * FROM Cars LIMIT 2, 4; --- 选择显示四行,但是不要查看前两行

SELECT * FROM Cars LIMIT 4 OFFSET 2; --- Offset 忽略前两行,但是显示四行

----##############################################
----### 输出数据的排序

SELECT * FROM Cars ORDER BY Price;
SELECT Name, Price FROM Cars ORDER BY Price DESC;

----##############################################
---和 WHERE 搭配使用

SELECT * FROM Orders WHERE Id=6;
SELECT * FROM Orders WHERE Customer = &quot;Smith&quot;;
SELECT * FROM Orders WHERE Customer LIKE &#39;B%&#39;;

#################################################
--- 检查重复记录
SELECT Customer FROM Orders WHERE Customer LIKE &#39;B%&#39;;

--- 去除重复
SELECT DISTINCT Customer FROM Orders WHERE Customer LIKE &#39;B%&#39;;

----#####################################################
----数据分组

SELECT sum(OrderPrice) AS Total, Customer FROM Orders GROUP BY Customer;

SELECT sum(OrderPrice) AS Total, Customer FROM Orders
 GROUP BY Customer HAVING sum(OrderPrice)&gt;1000;

----#######################################################
----### 限制条件

-- NOT NULL
-- UNIQUE
-- PRIMARY KEY
-- FOREIGN KEY
-- CHECK
-- DEFAULT

----### 创建表的时候, 声明不能有空值
CREATE TABLE People(Id INTEGER,LastName TEXT NOT NULL, FirstName TEXT NOT NULL, City TEXT);

INSERT INTO People VALUES(1,&#39;Hanks&#39;, &#39;Robert&#39;, &#39;New York&#39;);
INSERT INTO People VALUES(2, NULL, &#39;Marianne&#39;, &#39;Chicago&#39;);

----##########################################################
CREATE TABLE Brands(Id INTEGER, BrandName TEXT UNIQUE);
----#### 不符合条件时, 要报错
INSERT INTO Brands VALUES(1,&#39;Coca Cola&#39;);
INSERT INTO Brands VALUES(2,&#39;Pepsi&#39;);
INSERT INTO Brands VALUES(3,&#39;Pepsi&#39;);

---PRIMARY KEY 限制条件, PRIMARY KEY只能指定一个, 该列所有值为唯一的, 并且顺序增加. primary key是其他表格引用该表格的基础.
DROP TABLE Brands;
CREATE TABLE Brands(Id INTEGER PRIMARY KEY,BrandName TEXT);
INSERT INTO Brands(BrandName)VALUES(&#39;CocaCola&#39;);
INSERT INTO Brands(BrandName)VALUES(&#39;Pepsi&#39;);
INSERT INTO Brands(BrandName)VALUES(&#39;Sun&#39;);
INSERT INTO Brands(BrandName)VALUES(&#39;Oracle&#39;);
SELECT * FROM Brands;

----引用其他表中的id
FOREIGN KEY(AuthorId) REFERENCES

BEGIN TRANSACTION;
DROP TABLE IF EXISTS Books;
DROP TABLE IF EXISTS Authors;

CREATE TABLE Authors(AuthorId INTEGER PRIMARY KEY, Name TEXT);
INSERT INTO Authors VALUES(1,&#39;Jane Austen&#39;);
INSERT INTO Authors VALUES(2,&#39;Leo Tolstoy&#39;);
INSERT INTO Authors VALUES(3,&#39;Joseph Heller&#39;);
INSERT INTO Authors VALUES(4,&#39;Charles Dickens&#39;);

CREATE TABLE Books(BookId INTEGER PRIMARY KEY, TitleTEXT, AuthorId INTEGER, FOREIGN KEY(AuthorId) REFERENCES Authors(AuthorId));
INSERT INTO Books VALUES(1,&#39;Emma&#39;,1);
INSERT INTO Books VALUES(2,&#39;War and Peace&#39;,2);
INSERT INTO Books VALUES(3,&#39;Catch XII&#39;,3);
INSERT INTO Books VALUES(4,&#39;David Copperfield&#39;,4);
INSERT INTO Books VALUES(5,&#39;Good as Gold&#39;,3);
INSERT INTO Books VALUES(6,&#39;Anna Karenia&#39;,2);
COMMIT;

---将两个表格的id绑定(其中一个引用另外一个),则被引用表格中的数据不能直接删除
PRAGMA foreign_keys=1;
DELETE FROM Authors WHERE AuthorId=1;

CREATE TABLE Books(BookId INTEGER PRIMARY KEY, TitleTEXT, AuthorId INTEGER, FOREIGN KEY(AuthorId) REFERENCES Authors(AuthorId)ON DELETE CASCADE);

SELECT Name, Title FROM Authors NATURAL JOIN Books;

DELETE FROM Authors WHERE AuthorId=2;
SELECT Name, Title FROM Authors NATURAL JOIN Books;

.schema Orders --- 查看表格头以及各列的名称和数据类型

INSERT INTO Orders(OrderPrice, Customer) VALUES (-10,&#39;Johnson&#39;);

---默认值关键字 DEFAULT
CREATE TABLE Hotels(Id INTEGER PRIMARY KEY, NameTEXT, City TEXT DEFAULT &#39;not available&#39;);

INSERT INTO Hotels(Name) VALUES (&#39;Slovan&#39;);

----###############################################
----两个表格的合并

----三种类型的合INNER 并
-- (1) INNER JOIN,
-- (2) NATURAL INNER JOIN
-- (3) CROSS INNER JOIN

---(1)INNER JOIN,
SELECT Name, Day FROM Customers AS C JOIN Reservations AS R ON C.CustomerId = R.CustomerId;
--- 注意AS XX 是为数据表临时改名, 以方便引用

---以上句子可以用SELECT 实现相同的效果
SELECT Name, Day FROM Customers, Reservations WHERE Customers.CustomerId = Reservations.CustomerId;

---(2)NATURAL INNERJOIN
--- NATURALJOIN自动以两个表中相同的列名进行匹配
SELECT Name, Day FROM Customers NATURAL JOIN Reservations;

---(3)CROSS INNER JOIN 是将表1和表2所有项进行匹配,并无实际应用价值.

--- OUTER JOINS,也分为三种 (left outer joins,right outer joins,and full outer joins),但是SQLite只支持第一种 left outer joins
--- OUTER JOINS 查询左侧表格的所有内容,即便在右侧表格没有值,也将以NULL的形式给出

SELECT Name, Day FROM Customers LEFT JOIN Reservations ON Customers.CustomerId = Reservations.CustomerId;
---另一种方法选择
SELECT Name, Day FROM Customers LEFT JOIN Reservations USING(CustomerId);

----自动匹配另一个表格
NATURALLEFTOUTERJOIN
SELECT Name, Day FROM Customers NATURAL LEFT OUTER JOIN Reservations;

----#############################################################
----SQLite中的函数

----第一类 核心函数
SELECT sqlite_version()
SELECT random() AS Random;
SELECT abs(11),abs(-5),abs(0),abs(NULL);
SELECT max(Price),min(Price) FROM Cars;
SELECT upper (Name) AS &#39;Names in capitals&#39; FROM Friends;
SELECT lower (Name) AS &#39;Names in lowercase&#39; FROM Friends WHERE Id IN(1,2,3);
SELECT length(&#39;ZetCode&#39;);
SELECT total_changes() AS &#39;Total changes&#39;; --- 数据库连接以来INSERT ,UPDATE,orDELETE的次数
SELECT sqlite_compileoption_used(&#39;SQLITE_DEFAULT_FOREIGN_KEYS&#39;) AS &#39;FK&#39;; ---查看某选项的状态
SELECT typeof(12), typeof(&#39;ZetCode&#39;), typeof(33.2), typeof(NULL), typeof(x&#39;345edb&#39;);

----第二类 聚合函数
SELECT * FROM Cars;
SELECT count( * ) AS &#39;# of cars&#39; FROM Cars;--- 返回行数
SELECT count(Customer) AS &#39;# of orders&#39; FROM Orders;
SELECT count(DISTINCT Customer) AS &#39;# of customers&#39; FROM Orders;

----让sqlite显示NULL
.nullvalue NULL
CREATE TABLE TESTING(Id INTEGER);
INSERT INTO Testing VALUES(1),(2),(3),(NULL),(NULL);
SELECT last_insert_rowid();

--- count( * )和 count(Id)的区别,count( * )考虑NULL,而后者全部去掉NULL
SELECT count(*) AS &#39;# of rows&#39; FROM Testing;
SELECT count(Id) AS &#39;# of non NULL values&#39; FROM Testing;

---平均值
SELECT avg(Price) AS &#39;Average price&#39; FROM Cars;

---求和
SELECT sum(OrderPrice) AS Sum FROM Orders;

----第三类 日期和时间函数
SELECT date(&#39;now&#39;);
SELECT datetime(&#39;now&#39;);
SELECT time(&#39;now&#39;);
SELECT time();
SELECT date();
SELECT date(&#39;now&#39;,&#39;2 months&#39;);
SELECT date(&#39;now&#39;,&#39;-55 days&#39;);
SELECT date(&#39;now&#39;,&#39;start of year&#39;);
SELECT datetime(&#39;now&#39;,&#39;start of day&#39;);
SELECT date(&#39;now&#39;,&#39;weekday 6&#39;); --- 其中 Sunday is0, Monday 1,..., Saturday 6
SELECT date(&#39;now&#39;,&#39;start of year&#39;,&#39;10 months&#39;,&#39;weekday 4&#39;);
SELECT strftime(&#39;%d-%m-%Y&#39;);
SELECT &#39;Current day: &#39;|| strftime(&#39;%d&#39;);
SELECT &#39;Days to XMas: &#39;||(strftime(&#39;%j&#39;,&#39;2015-12-24&#39;)- strftime(&#39;%j&#39;,&#39;now&#39;));

---- ########### 视图 VIEWS #################

SELECT * FROM Cars;
CREATE VIEW CheapCars AS SELECT Name FROM Cars WHERE Price &lt;30000;
SELECT * FROM CheapCars;
.TABLE s
DROP VIEW CheapCars;
.TABLE s

--VIEW是一种虚拟表格
--记录数据操作
-- Triggers 记录

CREATE TABLE Log(Id INTEGER PRIMARY KEY, OldName TEXT, NewName TEXT,Date TEXT);

CREATE TRIGGER mytrigger UPDATE OF Name ON Friends

BEGIN
INSERT INTO Log(OldName, NewName,Date) VALUES(old.Name,new.Name, datetime(&#39;now&#39;));
END;

----查看 trigger
SELECT name, tbl_name FROM sqlite_master WHERE type=&#39;trigger&#39;;

SELECT * FROM Friends;
UPDATE FriendsSET Name=&#39;Frank&#39; WHERE Id=3;
SELECT * FROMLog;

SELECT name, tbl_name FROM sqlite_master WHERE type=&#39;trigger&#39;;

----SQLite命令组

----两种, 分别以commit和ROLLBACK结尾

BEGIN TRANSACTION;
CREATE TABLE Test(Id INTEGER NOT NULL);
INSERT INTO Test VALUES(1);
INSERT INTO Test VALUES(2);
INSERT INTO Test VALUES(3);
INSERT INTO Test VALUES(NULL);
COMMIT;

BEGIN TRANSACTION;
CREATE TABLE IF NOT EXISTS Test(Id INTEGER NOT NULL);
INSERT INTO Test VALUES(11);
INSERT INTO Test VALUES(12);
INSERT INTO Test VALUES(13);
INSERT INTO Test VALUES(NULL);
ROLLBACK;

--- ############### 导入和导出
.mode --查询模式

--- 导入CSV文件 .IMPORT
.import --- 文件名\表

---### 需要设定 字段的分隔符。
.mode CSV
.import C:/work/mydat.csv TABLE 1

--- 导出 .output
.head on
.mode csv
.output out_Cars.csv
SELECT * FROM Cars;
.output stdout

--- 导出为html格式
.header on
.separator &quot;,&quot;
.mode html
.output out_Cars.html
SELECT * FROM Cars;
.output stdout
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://helixcn.github.io/2015/11/05/2015-11-6-sqlit3/" data-id="ckmq42alp00e01k84d2gt1wbd" data-title="sqlite3 简明指南" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2015-10-30-mysql" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2015/10/29/2015-10-30-mysql/" class="article-date">
  <time class="dt-published" datetime="2015-10-29T09:13:54.000Z" itemprop="datePublished">2015-10-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2015/10/29/2015-10-30-mysql/">mySQL简明入门</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>详情请参考<br><a target="_blank" rel="noopener" href="http://downloads.mysql.com/docs/mysql-tutorial-excerpt-5.1-en.pdf">http://downloads.mysql.com/docs/mysql-tutorial-excerpt-5.1-en.pdf</a></p>
<pre><code class="SQL">mysql -u root -p --- 回车
--- 密码 12345

--- Ctrl + D 退出

--- 查看版本
SELECT VERSION(), CURRENT_DATE;

--- 查看数据库
SHOW DATABASES;

--- 创建数据库
 CREATE DATABASE menagerie;

--- 使用数据库
 USE menagerie

--- 创建表格
CREATE TABLE pet (name VARCHAR(20), owner VARCHAR(20), species VARCHAR(20), sex CHAR(1),birth DATE, death DATE);

--- 显示数据库中的表格的名称
SHOW TABLES;

--- 显示表格各列的属性
DESCRIBE pet;

--- 从本地读取文件
LOAD DATA LOCAL INFILE &#39;/path/pet.txt&#39; INTO TABLE pet;
注意, 如果是Windows, 要使用 LINES TERMINATED BY &#39;rn&#39;;

--- 在表格中插入一行
INSERT INTO pet VALUES (&#39;Puffball&#39;,&#39;Diane&#39;,&#39;hamster&#39;,&#39;f&#39;,&#39;1999-03-30&#39;,NULL);
INSERT INTO pet VALUES (&#39;Fluffy&#39;,&#39; Harold &#39;,&#39;cat &#39;,&#39;f &#39;,&#39;1993-02-04&#39;,NULL);
INSERT INTO pet VALUES (&#39;Claws &#39;,&#39;Gwen &#39;,&#39;cat &#39;,&#39;m &#39;,&#39;1994-03-17&#39;,NULL);
INSERT INTO pet VALUES (&#39;Buffy &#39;,&#39;Harold &#39;,&#39;dog &#39;,&#39;f &#39;,&#39;1989-05-13&#39;,NULL);
INSERT INTO pet VALUES (&#39;Fang &#39;,&#39;Benny&#39;,&#39; dog &#39;,&#39;m &#39;,&#39;1990-08-27&#39;,NULL);
INSERT INTO pet VALUES (&#39;Bowser &#39;,&#39;Diane &#39;,&#39;dog &#39;,&#39;m &#39;,&#39;1979-08-31&#39;,&#39;1995-07-29&#39;);
INSERT INTO pet VALUES (&#39;Chirpy&#39;,&#39; Gwen&#39;,&#39; bird&#39;,&#39; f&#39;,&#39; 1998-09-11&#39;,NULL)
INSERT INTO pet VALUES (&#39;Whistler&#39;,&#39; Gwen&#39;,&#39; bird&#39;,&#39; NULL&#39;, &#39;1997-12-09&#39;,NULL)
INSERT INTO pet VALUES (&#39;Slim&#39;,&#39; Benny&#39;,&#39; snake&#39;,&#39; m &#39;,&#39;1996-04-29&#39;,NULL)

--- 从数据表中获取数据 
---SELECT 的基本语句格式: 
---SELECT what_to_select
---FROM which_table
---WHERE conditions_to_satisfy;

--- 查询全部数据
SELECT * FROM pet;

--- 修改部分数据 
UPDATE pet SET birth = &#39;1989-08-31&#39; WHERE name = &#39;Bowser&#39;;

--- 查询部分数据 
SELECT * FROM pet WHERE name = &#39;Bowser&#39;;

--- 比较运算 
SELECT * FROM pet WHERE birth &gt;= &#39;1998-1-1&#39;;

--- 逻辑运算 AND
SELECT * FROM pet WHERE species = &#39;dog&#39; AND sex = &#39;f&#39;;

--- 逻辑运算 OR
SELECT * FROM pet WHERE species = &#39;snake&#39; OR species = &#39;bird&#39;;

--- 运算的优先级
SELECT * FROM pet WHERE (species = &#39;cat&#39; AND sex = &#39;m&#39;) OR (species = &#39;dog&#39; AND sex = &#39;f&#39;);

--- 选择特定的列
SELECT name, birth FROM pet;

SELECT owner FROM pet;

--- 去重复 
SELECT DISTINCT owner FROM pet;

--- SELECT 的基本组合
SELECT name, species, birth FROM pet WHERE species = &#39;dog&#39; OR species = &#39;cat&#39;;

--- 排序, 默认是 由小到大排序
SELECT name, birth FROM pet ORDER BY birth;

--- 由大到小排序
SELECT name, birth FROM pet ORDER BY birth DESC;

--- 多个列排序
SELECT name, species, birth FROM pet ORDER BY species, birth DESC;

--- 当前日期 
CURDATE()

--- 两个日期相隔时间
TIMESTAMPDIFF()

--- 形成新的一列 
AS age (见后面的例子)

--- 日期计算
SELECT name, birth, CURDATE(), TIMESTAMPDIFF(YEAR,birth,CURDATE()) AS age FROM pet;

--- 加入新一列的表格再排序, 按照name
SELECT name, birth, CURDATE(), TIMESTAMPDIFF(YEAR,birth,CURDATE()) AS age FROM pet ORDER BYname;

--- 加入新一列的表格再排序, 按照 age
SELECT name, birth, CURDATE(), TIMESTAMPDIFF(YEAR,birth,CURDATE()) AS age FROM pet ORDER BYage;

--- 判断 is not null
SELECT name, birth, death, TIMESTAMPDIFF(YEAR,birth,death) AS age FROM pet WHERE death IS NOT NULL ORDER BY age;

--- 时间计算
YEAR(), MONTH(), DAYOFMONTH()

--- 哪个月份出生 
SELECT name, birth, MONTH(birth) FROM pet;

--- 按照运算出的结果查找
SELECT name, birth FROM pet WHERE MONTH(birth) = 5;

--- 十二月份等的处理
SELECT name, birth FROM pet WHERE MONTH(birth) = MOD(MONTH(CURDATE()), 12) + 1;

--- 对NULL的判断
SELECT 1 IS NULL, 1 IS NOT NULL;

---匹配与正则表达式, 寻找name中以b开头的
SELECT * FROM pet WHERE name LIKE &#39;b%&#39;;

---寻找name中以fy结尾的
SELECT * FROM pet WHERE name LIKE &#39;%fy&#39;;

---寻找名字中含有w的
SELECT * FROM pet WHERE name LIKE &#39;%w%&#39;;

---寻找名字只包含五个字母的, 用五个_
SELECT * FROM pet WHERE name LIKE &#39;_____&#39;;

---正则表达式的关键字
REGEXP and NOT REGEXP operators (or RLIKE and NOT RLIKE)

---正则表达式
---. 任意单个字符
---[a-z] a到z的任意字符
---[0-9] 0到9的任意字符
---“*” 之前, 放任何字符, 表示的是任意重复次数的该字符
---.* 表示任意重复次数的任意字符
---^ 开始
---$ 结束

--- 正则表达式举例
--- 以b开始的人名(不区分大小写)
SELECT * FROM pet WHERE name REGEXP &#39;^b&#39;;

--- 匹配大小写 BINARY, 名字以小写的b开头的
SELECT * FROM pet WHERE name REGEXP BINARY &#39;^b&#39;;

--- 名字以fy结尾的
SELECT * FROM pet WHERE name REGEXP &#39;fy$&#39;;

--- 名字中含有w的
SELECT * FROM pet WHERE name REGEXP &#39;w&#39;;

--- 名字仅由五个字母组成
SELECT * FROM pet WHERE name REGEXP &#39;^.....$&#39;;
--或者 
SELECT * FROM pet WHERE name REGEXP &#39;^.&#123;5&#125;$&#39;;

--- 统计表格的行数 
SELECT COUNT(*) FROM pet;

--- GROUP BY, 针对每一个水平进行计算
SELECT owner, COUNT(*) FROM pet GROUP BY owner;
SELECT species, COUNT(*) FROM pet GROUP BY species;
SELECT sex, COUNT(*) FROM pet GROUP BY sex;

--- 分组可以同时考虑几个因素
SELECT species, sex, COUNT(*) FROM pet GROUP BY species, sex;

--- 进一步筛选, 只要 dog 或者 cat的部分记录
SELECT species, sex, COUNT(*) FROM pet WHERE species = &#39;dog&#39; OR species = &#39;cat&#39; GROUP BYspecies, sex;

--- 只保留已知性别的, 按照 species 和 sex 统计
SELECT species, sex, COUNT(*) FROM pet WHERE sex IS NOT NULL GROUP BY species, sex;

注意: select后面的列, 如果使用了count()函数, 则后面的group by后面, 必须跟上相同的列. 否则mysql会报错. 

------使用多个表格
---创建一个新的表
CREATE TABLE event (name VARCHAR(20), date DATE, type VARCHAR(15), remark VARCHAR(255));

---载入数据
LOAD DATA INFILE &#39;/home/jinlong/programming/mysql/event.txt&#39; INTO TABLE event;

---同时查询两个表格, 注意应该先将两个表格 
---用 INNER JOIN 合并.
---ON 表格合并的凭借 对于pet表格来说, 是name, 所以是 pet.name
----对于event表格来说, 也是name, 所以是event.name
---而筛选的条件,是 event表格中的type为 &#39;litter&#39;

SELECT pet.name, 
 (YEAR(date)-YEAR(birth)) - (RIGHT(date,5)&lt;RIGHT(birth,5)) AS age,remark
 FROM pet INNER JOIN event
ON pet.name = event.name 
 WHERE event.type = &#39;litter&#39;;

---为了计算的方便, 有时候可以将同一个表格进行 INNER JOIN
mysql&gt; SELECT p1.name, p1.sex, p2.name, p2.sex, p1.species
 FROM pet AS p1 INNER JOIN pet AS p2
ON p1.species = p2.species AND p1.sex = &#39;f&#39; AND p2.sex = &#39;m&#39;;

---查询数据库的名称
SELECT DATABASE();

---显示表名
SHOW TABLES;

---获取表格的结构
DESCRIBE pet;

---# MYSQL的批处理 从terminal运行
---UNIX平台
mysql &lt; batch-file 
---WINDOWS 平台
mysql -e &quot;source batch-file&quot;

---# 
---从terminal运行 mySQL的批处理文件
mysql -h host -u user -p &lt; batch-file

---从terminal运行 结果的分屏显示
mysql &lt; batch-file | more

---从terminal运行 输出结果导出到文件
mysql &lt; batch-file &gt; mysql.out

---从terminal运行 在批处理模式下显示输出
mysql -t

---从terminal运行 在批处理模式下, 保存输入的命令
mysql -vvv

---在mySQL中运行脚本文件
source filename;
或 . filename;


------------------------------------------------------------------##
--- 创建一个商品价目表, 并基于该表做各种查询

show databases;
create database test;
use test;

CREATE TABLE shop (
article INT(4) UNSIGNED ZEROFILL DEFAULT &#39;0000&#39; NOT NULL,
dealer CHAR(20)
DEFAULT &#39;&#39;
NOT NULL,
price
DOUBLE(16,2)
DEFAULT &#39;0.00&#39; NOT NULL,
PRIMARY KEY(article, dealer));

INSERT INTO shop VALUES
(1,&#39;A&#39;,3.45),(1,&#39;B&#39;,3.99),(2,&#39;A&#39;,10.99),(3,&#39;B&#39;,1.45),
(3,&#39;C&#39;,1.69),(3,&#39;D&#39;,1.25),(4,&#39;D&#39;,19.95);

SELECT * FROM shop;

---查找最贵商品
SELECT MAX(article) AS article FROM shop;

---查找最高价对应的货品, 供应商
SELECT article, dealer, price
FROM
shop
WHERE price=(SELECT MAX(price) FROM shop);

---每一组的最贵商品
SELECT article, MAX(price) AS price
FROM
shop
GROUP BY article;

---每组最贵商品所在的行
SELECT article, dealer, price
FROM
shop s1
WHERE price=(SELECT MAX(s2.price)
FROM shop s2
WHERE s1.article = s2.article);

---临时变量
SELECT @min_price:=MIN(price),@max_price:=MAX(price) FROM shop;
SELECT * FROM shop WHERE price=@min_price OR price=@max_price;

------------------------------------##
---# KEYS

CREATE TABLE person (
id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
name CHAR(60) NOT NULL,
PRIMARY KEY (id)
);

CREATE TABLE shirt (
id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
style ENUM(&#39;t-shirt&#39;, &#39;polo&#39;, &#39;dress&#39;) NOT NULL,
color ENUM(&#39;red&#39;, &#39;blue&#39;, &#39;orange&#39;, &#39;white&#39;, &#39;black&#39;) NOT NULL,
owner SMALLINT UNSIGNED NOT NULL REFERENCES person(id),
PRIMARY KEY (id)
);

INSERT INTO person VALUES (NULL, &#39;Antonio Paz&#39;);

SELECT @last := LAST_INSERT_ID();

INSERT INTO shirt VALUES
(NULL, &#39;polo&#39;, &#39;blue&#39;, @last),
(NULL, &#39;dress&#39;, &#39;white&#39;, @last),
(NULL, &#39;t-shirt&#39;, &#39;blue&#39;, @last);

INSERT INTO person VALUES (NULL, &#39;Lilliana Angelovska&#39;);

SELECT @last := LAST_INSERT_ID();

INSERT INTO shirt VALUES
(NULL, &#39;dress&#39;, &#39;orange&#39;, @last),
(NULL, &#39;polo&#39;, &#39;red&#39;, @last),
(NULL, &#39;dress&#39;, &#39;blue&#39;, @last),
(NULL, &#39;t-shirt&#39;, &#39;white&#39;, @last);

SELECT * FROM person;

##---查询keys
SELECT field1_index, field2_index FROM test_table
WHERE field1_index = &#39;1&#39; OR field2_index = &#39;1&#39;

--- 查询每个月的访问量

CREATE TABLE t1 (year YEAR(4), month INT(2) UNSIGNED ZEROFILL,
day INT(2) UNSIGNED ZEROFILL);
INSERT INTO t1 VALUES(2000,1,1),(2000,1,20),(2000,1,30),(2000,2,2),
(2000,2,23),(2000,2,23);


SELECT year,month,BIT_COUNT(BIT_OR(1&lt;&lt;day)) AS days FROM t1
GROUP BY year,month;


---为行增加 unique identity for new rows
AUTO_INCREMENT

CREATE TABLE animals (
id MEDIUMINT NOT NULL AUTO_INCREMENT,
name CHAR(30) NOT NULL,
PRIMARY KEY (id)
) ENGINE=INNODB;
INSERT INTO animals (name) VALUES
(&#39;dog&#39;),(&#39;cat&#39;),(&#39;penguin&#39;),
(&#39;lax&#39;),(&#39;whale&#39;),(&#39;ostrich&#39;);
SELECT * FROM animals;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://helixcn.github.io/2015/10/29/2015-10-30-mysql/" data-id="ckmq42aj2006u1k84gk7ea9lc" data-title="mySQL简明入门" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-2015-10-23-south" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2015/10/23/2015-10-23-south/" class="article-date">
  <time class="dt-published" datetime="2015-10-23T00:33:54.000Z" itemprop="datePublished">2015-10-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2015/10/23/2015-10-23-south/">诗一首 北方人在南方</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>当家乡随着云彩远去，</p>
<p>老屋也消失在天边,</p>
<p>游子的心，</p>
<p>便开始漂泊。</p>
<p>&nbsp;</p>
<p>当父母的叮咛随着汽笛的轰鸣远去，</p>
<p>小小的渔船消失在水天一线，</p>
<p>游子的心，</p>
<p>就注定开始漂泊。</p>
<p>&nbsp;</p>
<p>从北方，</p>
<p>吹来甘冽的风，</p>
<p>雾霾却遮住了你的双眼。</p>
<p>家乡，</p>
<p>已经干瘪成几个汉字。</p>
<p>父母的微笑，</p>
<p>都只映在屏幕上。</p>
<p>&nbsp;</p>
<p>在南方，</p>
<p>你在冬日的暖阳下，</p>
<p>徜徉在海滨的清风中。</p>
<p>家乡，</p>
<p>却化作一块云彩环绕着你的心，</p>
<p>时雨时晴，</p>
<p>幻化出儿时的风景。</p>
<p>&nbsp;</p>
<p>2015年10月23日</p>
<p>香港大埔</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://helixcn.github.io/2015/10/23/2015-10-23-south/" data-id="ckmq42aj1006s1k842bfja9gv" data-title="诗一首 北方人在南方" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AF%97%E6%AD%8C/" rel="tag">诗歌</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/11/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><a class="extend next" rel="next" href="/page/13/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/R%E7%BC%96%E7%A8%8B/" rel="tag">R编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E7%89%A9/" rel="tag">人物</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%99%E4%BD%9C/" rel="tag">写作</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">可视化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E4%B9%A6/" rel="tag">图书</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" rel="tag">图像处理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9C%B0%E7%90%86/" rel="tag">地理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A3%B0%E6%98%8E/" rel="tag">声明</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A9%E6%96%87/" rel="tag">天文</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%B9%E8%AF%9D%E5%BD%95/" rel="tag">对话录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%83%E5%BE%97/" rel="tag">心得</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%A5%E5%91%8A/" rel="tag">报告</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%92%E7%89%88/" rel="tag">排版</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%85%E4%B9%A1/" rel="tag">故乡</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%87%E6%9C%AC%E9%A6%86/" rel="tag">标本馆</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A4%8D%E7%89%A9%E5%88%86%E7%B1%BB/" rel="tag">植物分类</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A4%8D%E7%89%A9%E5%AD%A6%E5%90%8D/" rel="tag">植物学名</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B1%82%E8%81%8C/" rel="tag">求职</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" rel="tag">版本控制</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%80%81/" rel="tag">生态</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%80%81%E8%B5%84%E8%AE%AF/" rel="tag">生态资讯</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A0%94%E7%A9%B6%E8%B5%84%E8%AE%AF/" rel="tag">研究资讯</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B3%BB%E7%BB%9F%E5%8F%91%E8%82%B2/" rel="tag">系统发育</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%9F%E8%AE%A1/" rel="tag">统计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A1%8C%E6%91%84%E5%8C%86%E5%8C%86/" rel="tag">行摄匆匆</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A7%81%E9%97%BB%E5%BD%95/" rel="tag">见闻录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%97%E6%AD%8C/" rel="tag">诗歌</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6/" rel="tag">软件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9B%E5%8C%96/" rel="tag">进化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9A%8F%E6%83%B3/" rel="tag">随想</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9A%8F%E7%AC%94/" rel="tag">随笔</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A9%B3%E8%AE%BA/" rel="tag">驳论</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/R%E7%BC%96%E7%A8%8B/" style="font-size: 18.75px;">R编程</a> <a href="/tags/%E4%BA%BA%E7%89%A9/" style="font-size: 11.88px;">人物</a> <a href="/tags/%E5%86%99%E4%BD%9C/" style="font-size: 13.13px;">写作</a> <a href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/" style="font-size: 12.5px;">可视化</a> <a href="/tags/%E5%9B%BE%E4%B9%A6/" style="font-size: 10px;">图书</a> <a href="/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/" style="font-size: 11.88px;">图像处理</a> <a href="/tags/%E5%9C%B0%E7%90%86/" style="font-size: 17.5px;">地理</a> <a href="/tags/%E5%A3%B0%E6%98%8E/" style="font-size: 10.63px;">声明</a> <a href="/tags/%E5%A4%A9%E6%96%87/" style="font-size: 16.25px;">天文</a> <a href="/tags/%E5%AF%B9%E8%AF%9D%E5%BD%95/" style="font-size: 10px;">对话录</a> <a href="/tags/%E5%BF%83%E5%BE%97/" style="font-size: 10px;">心得</a> <a href="/tags/%E6%8A%A5%E5%91%8A/" style="font-size: 12.5px;">报告</a> <a href="/tags/%E6%8E%92%E7%89%88/" style="font-size: 13.75px;">排版</a> <a href="/tags/%E6%95%85%E4%B9%A1/" style="font-size: 10.63px;">故乡</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 10.63px;">数据库</a> <a href="/tags/%E6%A0%87%E6%9C%AC%E9%A6%86/" style="font-size: 14.38px;">标本馆</a> <a href="/tags/%E6%A4%8D%E7%89%A9%E5%88%86%E7%B1%BB/" style="font-size: 10px;">植物分类</a> <a href="/tags/%E6%A4%8D%E7%89%A9%E5%AD%A6%E5%90%8D/" style="font-size: 10px;">植物学名</a> <a href="/tags/%E6%B1%82%E8%81%8C/" style="font-size: 10px;">求职</a> <a href="/tags/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" style="font-size: 11.25px;">版本控制</a> <a href="/tags/%E7%94%9F%E6%80%81/" style="font-size: 16.88px;">生态</a> <a href="/tags/%E7%94%9F%E6%80%81%E8%B5%84%E8%AE%AF/" style="font-size: 10px;">生态资讯</a> <a href="/tags/%E7%A0%94%E7%A9%B6%E8%B5%84%E8%AE%AF/" style="font-size: 10px;">研究资讯</a> <a href="/tags/%E7%B3%BB%E7%BB%9F%E5%8F%91%E8%82%B2/" style="font-size: 10px;">系统发育</a> <a href="/tags/%E7%BB%9F%E8%AE%A1/" style="font-size: 18.13px;">统计</a> <a href="/tags/%E7%BC%96%E7%A8%8B/" style="font-size: 10.63px;">编程</a> <a href="/tags/%E8%A1%8C%E6%91%84%E5%8C%86%E5%8C%86/" style="font-size: 15px;">行摄匆匆</a> <a href="/tags/%E8%A7%81%E9%97%BB%E5%BD%95/" style="font-size: 10px;">见闻录</a> <a href="/tags/%E8%AF%97%E6%AD%8C/" style="font-size: 15.63px;">诗歌</a> <a href="/tags/%E8%BD%AF%E4%BB%B6/" style="font-size: 19.38px;">软件</a> <a href="/tags/%E8%BF%9B%E5%8C%96/" style="font-size: 10.63px;">进化</a> <a href="/tags/%E9%9A%8F%E6%83%B3/" style="font-size: 11.25px;">随想</a> <a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 20px;">随笔</a> <a href="/tags/%E9%A9%B3%E8%AE%BA/" style="font-size: 10px;">驳论</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">March 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">February 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/01/">January 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">May 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">February 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">December 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">August 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">June 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">May 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">April 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">February 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/01/">January 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/12/">December 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">November 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">October 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/08/">August 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/07/">July 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/03/">March 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/02/">February 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/12/">December 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">November 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">September 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/08/">August 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/07/">July 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/06/">June 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/05/">May 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">April 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/01/">January 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/08/">August 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/07/">July 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/06/">June 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/05/">May 2009</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/26/2021-3-26/">使用hexo生成和部署网站</a>
          </li>
        
          <li>
            <a href="/2021/03/25/2021-03-25/">用pkgdown为R程序包建立网站</a>
          </li>
        
          <li>
            <a href="/2021/03/18/2021-03-18/">为什么《xxxx在XX研究中取得进展》这类文章很少有人转发？</a>
          </li>
        
          <li>
            <a href="/2021/02/16/2021-02-16/">如何恢复森林？– 从嘉道理农场的森林恢复样地说起</a>
          </li>
        
          <li>
            <a href="/2020/12/30/2020-12-30/">群落系统发育研究不能脱离理论框架</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Jinlong Zhang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>